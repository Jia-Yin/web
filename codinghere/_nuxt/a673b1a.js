(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1145:function(e,t,n){"use strict";n.r(t);n(30),n(49);var r=n(8),o=(n(902),n(867)),c=n(32),l=n(843),d={components:{ProgTest:o.default},data:function(){return{reExam:!1,time:10,index:0,totalScore:0,skip:!1,finished:!1,problems:[],exam:null,record:{userid:null,examid:null,courseid:null,date:null,submits:{},score:0},recordId:null}},computed:{ready:function(){return this.problems&&this.problems.length>0},tick:function(){return this.$store.state.params.tick},eid:function(){return this.$route.params.eid},cid:function(){return this.$route.params.course}},created:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.d.collection("exams").doc(e.eid).get();case 2:n=t.sent,r=n.data(),e.exam=r,e.setExam();case 6:case"end":return t.stop()}}),t)})))()},methods:{skipproblem:function(){this.skip=!0},submit:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.correct&&(t.totalScore+=t.problems[t.index].score),t.record.submits[t.problems[t.index].id]=e,t.record.score=t.totalScore,console.log("Record",t.record),t.skip=!1,!t.finished&&t.index<t.problems.length-1?t.index++:t.leave();case 6:case"end":return n.stop()}}),n)})))()},setExam:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=e.$copyObject(e.exam.probs)).sort((function(e,t){return e.order-t.order!=0?e.order-t.order:Math.random()-.5})),e.time=60*e.exam.tlimit,e.problems=n,e.record.userid=e.$user("id"),e.record.examid=e.eid,e.record.examname=e.exam.name,e.record.courseid=e.cid,e.record.date=l.a.getToday(),e.record.finish=!1;case 10:case"end":return t.stop()}}),t)})))()},leave:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.record.spentTime=60*e.exam.tlimit-e.time,console.log("Final Record",e.record),e.$router.push("/admin/".concat(e.cid,"/exams/"));case 3:case"end":return t.stop()}}),t)})))()},mmss:function(e){return l.a.mmss(e)},hhmmss:function(e){return l.a.hhmmss(e)}},watch:{tick:function(e){this.time--,0===this.time&&this.leave()}}},m=n(55),component=Object(m.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",[n("b-navbar",{attrs:{variant:"light"}},[n("b-navbar-nav",{staticClass:"mr-auto"},[n("b-nav-text",{staticClass:"text-dark"},[e._v(e._s(e.$user("name")))])],1),e._v(" "),n("b-navbar-nav",{staticClass:"mr-auto"},[n("b-nav-text",{staticClass:"text-primary"},[e._v("\n                總分 "+e._s(e.exam&&e.exam.tscore)+"，限時\n                "+e._s(e.exam&&e.exam.tlimit)+" 分鐘；   本題佔分\n                "+e._s(e.problems[e.index]&&e.problems[e.index].score)+"， 限時\n                "+e._s(e.problems[e.index]&&e.mmss(e.problems[e.index].tlimit))+"\n                   剩餘考試時間 "+e._s(e.hhmmss(e.time))+"\n            ")])],1),e._v(" "),n("b-navbar-nav",{staticClass:"mr-auto"},[e.skip?e._e():n("b-button",{staticClass:"ml-3 btn-sm btn-outline-success",attrs:{variant:"outline-success"},on:{click:function(t){return e.skipproblem()}}},[e._v("跳過本題")]),e._v(" "),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-leave",modifiers:{"modal-leave":!0}}],staticClass:"ml-3 btn btn-sm btn-outline-danger",attrs:{variant:"outline-danger"}},[e._v("離開考場")]),e._v(" "),n("b-modal",{attrs:{id:"modal-leave",title:"溫馨提醒","ok-title":"確定","cancel-title":"取消","no-close-on-esc":!0,"no-close-on-backdrop":!0},on:{ok:function(t){return e.leave()}}},[n("p",{staticClass:"mt-4 text-danger"},[e._v("此視窗顯示時，計時不會暫停。")]),e._v(" "),n("p",{staticClass:"my-4 text-danger"},[e._v("\n                    離開考場等於交卷，不得再次進入！\n                    "),n("br"),e._v("確定要離開嗎？\n                ")])])],1),e._v(" "),n("b-navbar-nav",[n("b-nav-text",{staticClass:"text-dark"},[e._v(e._s(e.index+1)+" /\n                "+e._s(e.problems&&e.problems.length))])],1)],1),e._v(" "),e.ready&&"progtest"==e.problems[e.index].type?n("ProgTest",{key:e.index,attrs:{times:e.problems[e.index].tlimit,quiz:e.problems[e.index],submit:e.submit,skip:e.skip}}):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{ProgTest:n(867).default})},865:function(e,t,n){var content=n(875);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(61).default)("2e95a49a",content,!0,{sourceMap:!1})},867:function(e,t,n){"use strict";n.r(t);n(365),n(49);var r=n(8),o=n(843),c=n(860),l=n(32),d={components:{ProblemSolver:c.default},props:{quiz:Object,submit:Function,times:{type:Number,default:300},skip:{type:Boolean,default:!1},lang:{type:String,default:"c"},langs:{type:String,default:"c, cpp, py"},initcode:{type:String,default:""},correctHint:{type:String,default:"正確，提交並進下一題"}},data:function(){return{lastcode:{sourceLang:"c",sourceCode:""},showPass:!1,mycode:"",codelang:"c",channel:null,chnlabel:"None",time:0,timer:null,timing:!0,spendTime:0,result:null,judging:!1,submitResult:null,pass:!1,done:!1}},computed:{tick:function(){return this.$store.state.params.tick}},created:function(){this.mycode=this.initcode,this.codelang=this.lang},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:0==e.times?e.timing=!1:e.time=e.times;case 1:case"end":return t.stop()}}),t)})))()},methods:{isubmit:function(data){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,c,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=data.cdata,r=data.result,n.sourceLang==e.lastcode.sourceLang&&n.sourceCode==e.lastcode.sourceCode){t.next=9;break}return e.lastcode={sourceLang:n.sourceLang,sourceCode:n.sourceCode},c={uid:e.$user("id"),pid:e.quiz.id,created:o.a.getNow(),lang:n.sourceLang,code:n.sourceCode,status:r.RunStatus,score:r.Score},t.next=7,l.d.collection("submits").add(c);case 7:d=t.sent,c.id=d.id;case 9:"AC"===r.RunStatus&&(e.spendTime=e.timing?e.times-e.time:0,e.showPass=!0);case 10:case"end":return t.stop()}}),t)})))()},setLang:function(e){this.codelang=e},mmss:function(e){return o.a.mmss(e)},send:function(e){this.showPass||(this.spendTime=this.timing?this.times-this.time:0),this.showPass=!1,this.done=!0,this.judging=!1,this.submit({correct:e,uans:this.lastcode.sourceCode,usetime:this.spendTime,lang:this.lastcode.sourceLang})}},watch:{tick:function(e){this.time>0&&this.time--,0===this.time&&this.send(!1)},skip:function(e){console.log("V",e),e&&!this.done&&this.send(!1)}}},m=(n(874),n(55)),component=Object(m.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"qpanel"},[n("b-modal",{attrs:{centered:"",title:"通過測試","hide-footer":""},model:{value:e.showPass,callback:function(t){e.showPass=t},expression:"showPass"}},[n("p",{attrs:{align:"center"}},[n("b-button",{attrs:{variant:"success"},on:{click:function(t){return e.send(!0)}}},[e._v("下一題")])],1)]),e._v(" "),n("p",{staticClass:"timestatus"},[n("span",{staticClass:"type"},[e._v("《程式題》")]),e._v(" "),e.timing?n("span",[e._v("倒數計時 "+e._s(e.mmss(e.time)))]):n("span",[e._v("靜態測試")])]),e._v(" "),n("problem-solver",{attrs:{problem:e.quiz,lang:e.lang,langs:e.langs},on:{submit:e.isubmit}})],1)}),[],!1,null,"16ce9334",null);t.default=component.exports;installComponents(component,{ProblemSolver:n(860).default})},874:function(e,t,n){"use strict";n(865)},875:function(e,t,n){(t=n(60)(!1)).push([e.i,".tcenter[data-v-16ce9334]{text-align:center}.type[data-v-16ce9334]{color:#ff0}.qpanel[data-v-16ce9334]{background:#eee;padding:24px}.timestatus[data-v-16ce9334]{background:#00f;color:#fff;text-align:center}.result[data-v-16ce9334]{position:fixed;left:25%;top:25%;width:50%;height:50%;background:#ddd;z-index:100;padding:24px;border:2px solid green;overflow-y:scroll}",""]),e.exports=t}}]);