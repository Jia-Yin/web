(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1248:function(e,t,r){"use strict";r(946)},1249:function(e,t,r){(t=r(56)(!1)).push([e.i,'[data-v-1d6852aa] h1{color:#00f;font-family:"Arial";font-size:120%;margin:24px 0;padding-bottom:3px;border-bottom:1px solid #000}[data-v-1d6852aa] h2{color:#ff4500;font-size:110%;margin:16px 0 8px}section[data-v-1d6852aa]{padding:8px 0;color:red;margin:18px 0 6px;font-size:150%}[data-v-1d6852aa] .itemList{margin-top:8px}.container-fluid[data-v-1d6852aa]{margin:30px}.panel[data-v-1d6852aa]{margin-right:30px;position:relative}.newButton[data-v-1d6852aa]{position:absolute;top:12px;right:12px}',""]),e.exports=t},1361:function(e,t,r){"use strict";r.r(t);r(10),r(156),r(30),r(86),r(27),r(42),r(856),r(87),r(49);var n=r(7),o=r(26),c=r(855),l=r(907),d=r(860),m=r(864),f={components:{UserSelector:l.default,ProblemSelector:d.default,LocaleInput:m.default},data:function(){return{cnLang:"en",courseNews:null,selectUser:!1,kind:"",playgroundStat:{},courseScores:[],scoreFields:[],courses:[],coursesAll:{},curCourse:null,curCourseAll:null,itemName:!1,courseItems:[],queueNumber:null,cunits:[],curUnit:null,selUnitProb:!1,unitIdx:null,showItem:"ListCourse",showUnitUpdate:!1,infoAlert:!1,courseEditMode:!1,unitEditMode:!1,problems:[],pgproblems:[],info:{title:"",message:""},locales:[{zh:"中文"}],unitForm:{name:"",startDate:"",endDate:"",probs:[]},localeText:{AdminCourse_Title:"課程",Common_Edit:"編輯",Common_Copy:"複製",Common_New:"新增"}}},created:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,i,o,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.localeText=e.$updateLocaleText(e.localeText),t.next=3,e.$store.dispatch("getCourse","LIST");case 3:if(r=t.sent)for((n=Object.keys(r)).sort(),i=0;i<n.length;i++)(o=r[n[i]]).id=n[i],"admin"==e.$user("role")||"maintainer"==e.$user("role")?e.courses.push(o):(l=e.$user("id"),d=!1,o.teachers&&c.a.findIdPos(o.teachers,l)>=0&&(d=!0),!d&&o.assistants&&c.a.findIdPos(o.assistants,l)>=0&&(d=!0),d&&e.courses.push(o));case 5:case"end":return t.stop()}}),t)})))()},methods:{selectDone:function(e){this.unitForm.probs=e,this.selUnitProb=!1},sname:function(e){return this.curCourseAll&&this.curCourseAll.students&&this.curCourseAll.students[e]?this.curCourseAll.students[e].name:"Wait..."},updateUnit:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var i,r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i=0;i<e.unitForm.probs.length;i++)delete e.unitForm.probs[i]._showDetails,delete e.unitForm.probs[i].tags;r=e.$copyObject(e.unitForm),n=e.curCourseAll.units?e.$copyObject(e.curCourseAll.units):[],e.unitEditMode?n.splice(e.unitIdx,1,r):n.push(r),o={units:n,updated:c.a.getNow()},e.$store.dispatch("updateCourse",{id:e.curCourseAll.id,value:o}),e.$set(e.curCourseAll,"units",n),e.cunits=n,e.showUnitUpdate=!1;case 9:case"end":return t.stop()}}),t)})))()},editUnit:function(e){this.unitEditMode=!0,this.unitForm=this.$copyObject(this.cunits[e]),this.unitIdx=e,this.showUnitUpdate=!0},createUnit:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.unitEditMode=!1,0!=e.problems.length){t.next=7;break}return t.next=4,o.d.collection("problems").doc("BASE").get();case 4:r=t.sent,n=r.data(),r.exists&&(e.problems=c.a.obj2arr(n));case 7:e.showUnitUpdate=!0;case 8:case"end":return t.stop()}}),t)})))()},updateCourseSetting:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,i,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.$copyObject(e.courseNews),(n={news:r}).queueNumber=e.queueNumber,e.curCourseAll.queueNumber&&e.curCourseAll.queueNumber==e.queueNumber){t.next=20;break}i=0;case 5:if(!(i<e.queueNumber)){t.next=20;break}return l="queue"+(i+1),t.next=9,o.d.collection("courses").doc(e.curCourse.id).collection("tasks").doc(l).get();case 9:if(!t.sent.exists){t.next=15;break}return t.next=13,o.d.collection("courses").doc(e.curCourse.id).collection("tasks").doc(l).update({updated:c.a.getNow()});case 13:t.next=17;break;case 15:return t.next=17,o.d.collection("courses").doc(e.curCourse.id).collection("tasks").doc(l).set({updated:c.a.getNow()});case 17:i++,t.next=5;break;case 20:return t.next=22,e.$store.dispatch("updateCourse",{id:e.curCourse.id,value:n});case 22:e.$set(e.curCourseAll,"news",r),e.$set(e.curCourseAll,"queueNumber",e.queueNumber),e.infoAlert=!0,e.info={title:"Setting",message:"OK"};case 26:case"end":return t.stop()}}),t)})))()},processCourseTask:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,l,d,m,f,h,v,_,i,x,w,C,k,y,S,P,A,$,u,N,T,U;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.curCourseAll.students?e.$copyObject(e.curCourseAll.students):{},n=e.curCourseAll.scores?e.$copyObject(e.curCourseAll.scores):{},t.next=4,o.d.collection("problems").doc("STAT").get();case 4:if((l=t.sent).exists){t.next=12;break}return d={updated:c.a.getNow()},t.next=9,o.d.collection("problems").doc("STAT").set(d);case 9:m=d,t.next=14;break;case 12:(m=l.data()).updated=c.a.getNow();case 14:f="playground"!=e.curCourseAll.id,h=e.curCourseAll.units,v=3,(_=e.$system("setting"))&&_.queueNumber&&(v=_.queueNumber),e.curCourseAll.queueNumber&&(v=e.curCourseAll.queueNumber),i=0;case 21:if(!(i<v)){t.next=54;break}return x="queue"+(i+1),t.next=25,o.d.collection("courses").doc(e.curCourse.id).collection("tasks").doc(x).get();case 25:if(!(w=t.sent).exists){t.next=51;break}C=w.data(),t.t0=regeneratorRuntime.keys(C);case 29:if((t.t1=t.t0()).done){t.next=48;break}if("updated"!=(k=t.t1.value)){t.next=33;break}return t.abrupt("continue",29);case 33:if("S_"!=k.substring(0,2)||!f){t.next=44;break}if(y=k.substring(2),r[y]||(r[y]={name:C[k].name,stdID:C[k].stdID}),!C[k].score){t.next=44;break}return t.next=39,o.d.collection("users").doc(y).get();case 39:if(S=t.sent,P=S.data(),A=[],P.courses&&P.courses[e.curCourseAll.id])for($=P.courses[e.curCourseAll.id].units,u=0;u<h.length;u++)N=h[u].name,$[N]?A.push($[N].score):A.push(0);n[y]=A;case 44:"P_"==k.substring(0,2)&&(T=k.substring(20),m[T]||(m[T]={TS:0,TP:0}),m[T].TS+=1,1==C[k]&&(m[T].TP+=1)),C[k]=o.b.firestore.FieldValue.delete(),t.next=29;break;case 48:return C.updated=c.a.getNow(),t.next=51,o.d.collection("courses").doc(e.curCourse.id).collection("tasks").doc(x).update(C);case 51:i++,t.next=21;break;case 54:return t.next=56,o.d.collection("problems").doc("STAT").set(m);case 56:if(e.playgroundStat=m,!f){t.next=63;break}return U={scores:n,students:r,updated:c.a.getNow()},t.next=61,e.$store.dispatch("updateCourse",{id:e.curCourseAll.id,value:U});case 61:e.$set(e.curCourseAll,"scores",n),e.$set(e.curCourseAll,"students",r);case 63:case"end":return t.stop()}}),t)})))()},prepareCourseContent:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("playground"==(r=e.curCourseAll.id)){t.next=9;break}return t.next=4,e.$store.dispatch("getCourseT",r);case 4:e.curCourseAll=t.sent,e.curCourseAll.id=r,e.courseNews=Object.assign({},e.curCourseAll.news),t.next=13;break;case 9:return t.next=11,e.$content("playground").fetch();case 11:(n=t.sent)&&(o=n.KEY,l=n.DATA,e.pgproblems=c.a.decode(o,l));case 13:e.processCourseTask();case 14:case"end":return t.stop()}}),t)})))()},showPGProblem:function(e){var t=this.$selectUserLocaleText(e.title);if(this.playgroundStat[e.id]){var r=this.playgroundStat[e.id];t+=" (".concat(r.TP,"/").concat(r.TS,")")}else t+=" (0/0)";return t},showCourseItem:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:"basic"==e.id&&(t.showItem="courseBasic",t.itemName="Basic"),"units"==e.id&&(t.curCourseAll.units?t.cunits=t.$copyObject(t.curCourseAll.units):t.cunits=[],t.showItem="courseUnits",t.itemName="Units"),"students"==e.id&&(t.showItem="courseStudents",t.itemName="Students"),"scores"==e.id&&(t.showItem="courseScores",t.itemName="Scores"),"setting"==e.id&&(t.queueNumber=3,(n=t.$system("setting"))&&n.queueNumber&&(t.queueNumber=n.queueNumber),t.coursesAll.queueNumber&&(t.queueNumber=t.coursesAll.queueNumber),t.showItem="courseSetting",t.itemName="Setting");case 5:case"end":return r.stop()}}),r)})))()},showCourse:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.curCourse=e,r.next=3,t.$store.dispatch("getCourse",e.id);case 3:if((n=r.sent)||"playground"!=e.id){r.next=11;break}return o={name:"Playground"},r.next=8,t.$store.dispatch("setCourse",{id:"playground",value:o});case 8:t.curCourseAll={name:"Playground",id:"playground"},r.next=14;break;case 11:t.curCourseAll=n,t.curCourseAll.id=e.id,t.courseItems=[{id:"basic",name:"Basic"},{id:"units",name:"Units"},{id:"students",name:"Students"},{id:"scores",name:"Scores"},{id:"setting",name:"Setting"}];case 14:return r.next=16,t.prepareCourseContent();case 16:t.showItem="showCourse",t.itemName=null;case 18:case"end":return r.stop()}}),r)})))()},showUnit:function(){},home:function(){this.showItem="ListCourse",this.curCourse=null},courseLabel:function(e){var t=e.name;return e.teacher&&e.note?t+=" (".concat(e.teacher," / ").concat(e.note,")"):e.teacher?t+=" (".concat(e.teacher,")"):e.note&&(t+=" (".concat(e.note,")")),t},updateCourse:function(data){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,l,d,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.$copyObject(data),"edit"!=data.mode){t.next=15;break}return r.id&&delete r.id,t.next=5,e.$store.dispatch("updateCourse",{id:e.curCourse.id,value:r});case 5:return r.id=e.curCourse.id,(n=c.a.findIdPos(e.courses,r.id))>=0&&(e.courses[n]=r),o=c.a.arr2obj(e.courses),t.next=11,e.$store.dispatch("setCourse",{id:"LIST",value:o});case 11:e.infoAlert=!0,e.info={title:"Update",message:"OK"},t.next=27;break;case 15:return r.id&&delete r.id,l=e.courses.length,d="C"+l.toString().padStart(6,"0"),t.next=20,e.$store.dispatch("setCourse",{id:d,value:r});case 20:return r.id=d,e.courses.push(r),m=c.a.arr2obj(e.courses),t.next=25,e.$store.dispatch("setCourse",{id:"LIST",value:m});case 25:e.infoAlert=!0,e.info={title:"Create",message:"OK"};case 27:e.$router.push("/admin/courses");case 28:case"end":return t.stop()}}),t)})))()}}},h=(r(1248),r(55)),component=Object(h.a)(f,(function(){var e=this,t=this,r=t.$createElement,n=t._self._c||r;return n("b-container",{attrs:{fluid:""}},[n("b-modal",{attrs:{title:t.info.title},model:{value:t.infoAlert,callback:function(e){t.infoAlert=e},expression:"infoAlert"}},[t._v(t._s(t.info.message))]),t._v(" "),n("div",{staticClass:"panel"},[n("b-breadcrumb",[n("b-breadcrumb-item",{on:{click:t.home}},[n("b-icon",{attrs:{icon:"house-fill",scale:"1.25","shift-v":"1.25","aria-hidden":"true"}}),t._v("\n                "+t._s(t.localeText.AdminCourse_Title)+"\n            ")],1),t._v(" "),t.curCourse?n("b-breadcrumb-item",{on:{click:function(e){return t.showCourse(t.curCourse)}}},[t._v(t._s(t.curCourse.name))]):t._e(),t._v(" "),t.itemName?n("b-breadcrumb-item",{on:{click:t.showCourseItem}},[t._v(t._s(t.itemName))]):t._e(),t._v(" "),t.curCourse?t._e():n("b-button",{staticClass:"newButton",attrs:{size:"sm",variant:"primary"},on:{click:function(e){t.showItem="addCourse"}}},[t._v(t._s(t.localeText.Common_New))])],1),t._v(" "),"ListCourse"==t.showItem?n("div",[n("b-table",{attrs:{items:t.courses,fields:["label"],small:"","thead-class":"d-none"},scopedSlots:t._u([{key:"cell(label)",fn:function(data){return[n("b-link",{on:{click:function(e){return t.showCourse(data.item)}}},[t._v(t._s(t.courseLabel(data.item)))])]}}],null,!1,1493537204)})],1):t._e(),t._v(" "),"showCourse"==t.showItem?n("div",{staticClass:"mt-3 ml-3"},["playground"==t.curCourse.id?n("div",[n("b-table",{attrs:{items:t.pgproblems,fields:["label"],small:"","thead-class":"d-none"},scopedSlots:t._u([{key:"cell(label)",fn:function(data){return[t._v("\n                        "+t._s(t.showPGProblem(data.item))+"\n                    ")]}}],null,!1,1946580280)})],1):n("div",[n("b-table",{attrs:{items:t.courseItems,fields:["name"],small:"","thead-class":"d-none"},scopedSlots:t._u([{key:"cell(name)",fn:function(data){return[n("b-link",{on:{click:function(e){return t.showCourseItem(data.item)}}},[t._v(t._s(data.value))])]}}],null,!1,1171554821)})],1)]):t._e(),t._v(" "),"courseUnits"==t.showItem?n("div",{staticClass:"mt-3"},[t.cunits.length>0?n("div",t._l(t.cunits,(function(e,r){return n("p",{key:e+r},[t._v("\n                    "+t._s(r+1)+". "+t._s(e.name)+" : "+t._s(e.startDate)+"-"+t._s(e.endDate)+"\n                    "),n("b-link",{staticClass:"ml-3 text-info",on:{click:function(e){return t.editUnit(r)}}},[t._v("Edit")]),n("br"),t._v(" "),t._l(e.probs,(function(e,r){return n("span",{key:e.id,staticClass:"ml-3 text-primary"},[t._v("\n                        ("+t._s(r+1)+")\n                        "+t._s(t.$selectUserLocaleText(e.title))+"\n                    ")])}))],2)})),0):n("div",[t._v("No any units.")]),t._v(" "),n("div",{staticClass:"mt-3",staticStyle:{"text-align":"center"}},[n("b-button",{attrs:{size:"sm",pill:"",center:"",variant:"success"},on:{click:t.createUnit}},[t._v("\n                    New\n                ")])],1),t._v(" "),t.showUnitUpdate?n("div",{staticClass:"mt-4"},[n("b-input",{staticClass:"mb-3",attrs:{placeholder:"Name"},model:{value:t.unitForm.name,callback:function(e){t.$set(t.unitForm,"name",e)},expression:"unitForm.name"}}),t._v(" "),n("b-input",{staticClass:"mb-3",attrs:{placeholder:"Start Date"},model:{value:t.unitForm.startDate,callback:function(e){t.$set(t.unitForm,"startDate",e)},expression:"unitForm.startDate"}}),t._v(" "),n("b-input",{staticClass:"mb-3",attrs:{placeholder:"End Date"},model:{value:t.unitForm.endDate,callback:function(e){t.$set(t.unitForm,"endDate",e)},expression:"unitForm.endDate"}}),t._v(" "),n("p",t._l(t.unitForm.probs,(function(e,r){return n("span",{key:"u"+e.id,staticClass:"ml-3 text-primary"},[t._v("\n                        ("+t._s(r+1)+")\n                        "+t._s(t.$selectUserLocaleText(e.title))+"\n                    ")])})),0),t._v(" "),n("p",{attrs:{align:"center"}},[n("b-button",{attrs:{size:"sm",variant:"success"},on:{click:function(e){t.showUnitUpdate=!1}}},[t._v("Cancel")]),t._v(" "),n("b-button",{staticClass:"ml-3",attrs:{size:"sm",variant:"success"},on:{click:function(e){t.selUnitProb=!0}}},[t._v("Set Problems")]),t._v(" "),n("b-button",{staticClass:"ml-3",attrs:{size:"sm",variant:"success"},on:{click:t.updateUnit}},[t._v("Update")])],1),t._v(" "),n("b-modal",{attrs:{size:"xl",title:"Select Problems","hide-footer":""},model:{value:t.selUnitProb,callback:function(e){t.selUnitProb=e},expression:"selUnitProb"}},[n("problem-selector",{staticClass:"mt-4",attrs:{oriProblems:t.problems,selProblems:t.unitForm.probs,selText:t.unitForm.name,OKText:"Set Unit Problems"},on:{OK:t.selectDone}})],1)],1):t._e()]):t._e(),t._v(" "),"courseStudents"==t.showItem?n("div",{staticClass:"mt-3"},[t.curCourseAll.students?n("div",t._l(t.curCourseAll.students,(function(e,r,o){return n("p",{key:e.name},[t._v("\n                    "+t._s(o+1)+".\n                    "),n("span",{staticClass:"ml-3",staticStyle:{display:"inline-block",width:"150px"}},[t._v(t._s(e.stdID))]),t._v(" "),n("span",{staticClass:"ml-3"},[t._v(t._s(t.sname(r)))])])})),0):t._e()]):t._e(),t._v(" "),"courseScores"==t.showItem?n("div",{staticClass:"mt-3"},[t.curCourseAll.scores?n("div",t._l(t.curCourseAll.scores,(function(e,r,o){return n("p",{key:r},[t._v("\n                    "+t._s(o+1)+". "+t._s(t.sname(r))+" => "+t._s(e)+"\n                ")])})),0):t._e()]):t._e(),t._v(" "),"courseSetting"==t.showItem?n("div",{staticClass:"mt-3"},[n("section",[t._v("Task Queue")]),t._v("\n            Queue Number: "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.queueNumber,expression:"queueNumber"}],attrs:{size:"sm"},domProps:{value:t.queueNumber},on:{input:function(e){e.target.composing||(t.queueNumber=e.target.value)}}}),t._v(" "),n("section",[t._v("News")]),t._v(" "),n("b-row",[n("b-col",{attrs:{cols:"6"}},[n("locale-input",{attrs:{rows:12},on:{curLang:function(t){e.cnLang=t}},model:{value:t.courseNews,callback:function(e){t.courseNews=e},expression:"courseNews"}})],1),t._v(" "),n("b-col",{attrs:{cols:"6"}},[n("div",{domProps:{innerHTML:t._s(t.$md.render(t.$selectLocaleText(t.courseNews,t.cnLang)))}})])],1),t._v(" "),n("div",{staticClass:"mt-3",staticStyle:{"text-align":"center"}},[n("b-button",{attrs:{size:"sm",pill:"",center:"",variant:"primary"},on:{click:t.updateCourseSetting}},[t._v("\n                    Update\n                ")])],1)],1):t._e()],1)],1)}),[],!1,null,"1d6852aa",null);t.default=component.exports;installComponents(component,{ProblemSelector:r(860).default,LocaleInput:r(864).default})},855:function(e,t,r){"use strict";r(10),r(14),r(22),r(86),r(9),r(856),r(29),r(15);var n=r(228),o=r.n(n),c={pad:function(e){return("0"+e).slice(-2)},mmss:function(e){var t=Math.floor(e/60);return e%=60,"".concat(this.pad(t),":").concat(this.pad(e))},hhmmss:function(e){var t=Math.floor(e/60);e%=60;var r=Math.floor(t/60);return t%=60,"".concat(this.pad(r),":").concat(this.pad(t),":").concat(this.pad(e))},getToday:function(){var e=new Date,dd=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0");return e.getFullYear()+t+dd},getNow:function(){var e=new Date;return""+e.getFullYear()+this.pad(e.getMonth()+1)+this.pad(e.getDate())+this.pad(e.getHours())+this.pad(e.getMinutes())+this.pad(e.getSeconds())},obj2arr:function(e){var t=[],r=Object.keys(e);return r.sort(),r.forEach((function(r){t.push(Object.assign({id:r},e[r]))})),t},arr2obj:function(e){var t={};return e.forEach((function(e){var r=JSON.parse(JSON.stringify(e)),n=e.id;delete r.id,t[n]=r})),t},getOptions:function(e){var t=[];return e.split("#@@#").forEach((function(e){var s=e.split("#@");t.push({text:s[0],value:s[1]})})),t},findIdPos:function(e,t){if(!e)return-1;for(var r=0;r<e.length;r++)if(t==e[r].id)return r;return-1},encode:function(e,t){return new o.a(e).encrypt(t)},decode:function(e,t){return new o.a(e).decrypt(t)}};t.a=c},856:function(e,t,r){"use strict";var n=r(8),o=r(857).start;n({target:"String",proto:!0,forced:r(858)},{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},857:function(e,t,r){var n=r(50),o=r(229),c=r(52),l=Math.ceil,d=function(e){return function(t,r,d){var m,f,h=String(c(t)),v=h.length,_=void 0===d?" ":String(d),x=n(r);return x<=v||""==_?h:(m=x-v,(f=o.call(_,l(m/_.length))).length>m&&(f=f.slice(0,m)),e?h+f:f+h)}};e.exports={start:d(!1),end:d(!0)}},858:function(e,t,r){var n=r(127);e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},859:function(e,t,r){"use strict";r.r(t);r(156),r(49);var n=r(7),o=(r(867),{props:{problems:Array,showID:{type:Boolean,default:!1},showTag:{type:Boolean,default:!1},showFilter:{type:Boolean,default:!1},showDetail:{type:Boolean,default:!1},showArrow:{type:Boolean,default:!1},showDown:{type:Boolean,default:!1},editProblem:{type:Function,default:null},copyProblem:{type:Function,default:null}},data:function(){return{pfields:[],pfilter:null,localeText:{AdminProblem_Playground:"練習廣場",AdminProblem_ProbEdit:"題目編修",AdminProblem_ProbList:"題目清單",Common_Edit:"編輯",Common_Copy:"複製"}}},created:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.localeText=e.$updateLocaleText(e.localeText),e.showID&&e.pfields.push({key:"id",sortable:!0}),e.pfields.push({key:"title",sortable:!0,formatter:e.$selectUserLocaleText}),e.showTag&&e.pfields.push({key:"tags",sortable:!0}),(e.showArrow||e.showDetail||e.editProblem||e.copyProblem)&&e.pfields.push({key:"actions",label:"Actions"});case 5:case"end":return t.stop()}}),t)})))()},mounted:function(){},methods:{moveUp:function(e){if(e>0){var t=this.$copyObject(this.problems[e]);this.problems.splice(e,1),this.problems.splice(e-1,0,t)}},moveDown:function(e){if(e<this.problems.length-1){var t=this.$copyObject(this.problems[e+1]);this.problems.splice(e+1,1),this.problems.splice(e,0,t)}},onRowSelected:function(e){this.$emit("rowSelected",e)},showProblem:function(e){return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.toggleDetails();case 1:case"end":return t.stop()}}),t)})))()}}}),c=(r(870),r(55)),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.showFilter?r("p",{staticClass:"p-0 mb-2"},[r("span",[e._v("Filter: "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.pfilter,expression:"pfilter"}],domProps:{value:e.pfilter},on:{input:function(t){t.target.composing||(e.pfilter=t.target.value)}}})])]):e._e(),e._v(" "),r("b-table",{attrs:{bordered:"",items:e.problems,selectable:"","select-mode":"multi",fields:e.pfields,filter:e.pfilter},on:{"row-selected":e.onRowSelected},scopedSlots:e._u([e.showDetail||e.editProblem||e.copyProblem||e.showArrow?{key:"cell(actions)",fn:function(t){return[e.showDetail?r("b-link",{staticClass:"mr-1",attrs:{size:"sm"},on:{click:function(r){return e.showProblem(t)}}},[t.detailsShowing?r("b-icon",{attrs:{icon:"eye-slash"}}):r("b-icon",{attrs:{icon:"eye"}})],1):e._e(),e._v(" "),e.editProblem?r("b-link",{staticClass:"mr-1",on:{click:function(r){return e.editProblem(t.item)}}},[r("b-icon",{attrs:{icon:"pen"}})],1):e._e(),e._v(" "),e.copyProblem?r("b-link",{staticClass:"mr-1",on:{click:function(r){return e.copyProblem(t.item)}}},[r("b-icon",{attrs:{icon:"back"}})],1):e._e(),e._v(" "),e.showArrow?r("b-link",{staticClass:"mr-1",on:{click:function(r){return e.moveUp(t.index)}}},[r("b-icon",{attrs:{icon:"arrow-up"}})],1):e._e(),e._v(" "),e.showArrow?r("b-link",{staticClass:"mr-1",on:{click:function(r){return e.moveDown(t.index)}}},[r("b-icon",{attrs:{icon:"arrow-down"}})],1):e._e()]}}:null,e.showDetail?{key:"row-details",fn:function(t){return[r("b-card",[r("p",[e._v(e._s(t.item.id)+": "+e._s(e.$selectUserLocaleText(t.item.title)))]),e._v(" "),r("p",{domProps:{innerHTML:e._s(e.$md.render(e.$selectUserLocaleText(t.item.description)))}}),e._v(" "),r("p",[e._v("TAGS: "+e._s(t.item.tags))])])]}}:null],null,!0)})],1)}),[],!1,null,"2398be4f",null);t.default=component.exports},860:function(e,t,r){"use strict";r.r(t);r(156);var n=r(859),o=r(855),c={props:{oriProblems:Array,selProblems:Array,selText:{type:String,Default:""},OKText:{type:String,Default:"OK"}},components:{ProblemTable:n.default},data:function(){return{leftSelected:null,rightSelected:null,leftProblems:[],rightProblems:[],localeText:{AdminProblem_Playground:"練習廣場",AdminProblem_ProbEdit:"題目編修",AdminProblem_ProbList:"題目清單",Common_Edit:"編輯",Common_Copy:"複製"}}},created:function(){this.localeText=this.$updateLocaleText(this.localeText),this.initSelection()},mounted:function(){},methods:{done:function(){this.$emit("OK",this.rightProblems)},initSelection:function(){var e=[];if(this.selProblems&&this.selProblems.length>0)for(var i=0;i<this.selProblems.length;i++)e.push(this.selProblems[i]);for(var t=[],r=0;r<this.oriProblems.length;r++){var n=this.oriProblems[r];o.a.findIdPos(e,n.id)<0&&t.push(n)}this.leftProblems=t,this.rightProblems=e},selectItems:function(){if(this.leftSelected)for(var i=0;i<this.leftSelected.length;i++){var e=this.leftSelected[i];this.rightProblems.push(e);var t=o.a.findIdPos(this.leftProblems,e.id);t>=0&&this.leftProblems.splice(t,1)}},deSelectItems:function(){if(this.rightSelected)for(var i=0;i<this.rightSelected.length;i++){var e=this.rightSelected[i];this.leftProblems.push(e);var t=o.a.findIdPos(this.selProblems,e.id);t>=0&&this.rightProblems.splice(t,1)}}},watch:{oriProblems:function(e){this.initSelection()},selProblems:function(e){this.initSelection()}}},l=(r(872),r(55)),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"d-flex justify-content-start align-items-top"},[r("problem-table",{attrs:{problems:e.leftProblems,showID:"",showDetail:"",showFilter:""},on:{rowSelected:function(t){return e.leftSelected=t}}}),e._v(" "),r("div",{staticClass:"mx-5"},[r("b-button",{attrs:{block:"",variant:"success",size:"sm"},on:{click:e.selectItems}},[r("b-icon",{attrs:{icon:"arrow-right"}})],1),e._v(" "),r("b-button",{attrs:{block:"",variant:"success",size:"sm"},on:{click:e.deSelectItems}},[r("b-icon",{attrs:{icon:"arrow-left"}})],1)],1),e._v(" "),r("div",[r("p",{staticClass:"mb-2 p-0",attrs:{align:"right"}},[r("span",{staticClass:"mr-3"},[e._v(e._s(e.selText))]),e._v(" "),r("b-button",{attrs:{size:"sm",variant:"success"},on:{click:e.done}},[e._v(e._s(e.OKText))])],1),e._v(" "),r("problem-table",{attrs:{problems:e.rightProblems,showID:"",showArrow:""},on:{rowSelected:function(t){return e.rightSelected=t}}})],1)],1)])}),[],!1,null,"c90387ec",null);t.default=component.exports;installComponents(component,{ProblemTable:r(859).default})},861:function(e,t,r){var content=r(869);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(57).default)("75a234fb",content,!0,{sourceMap:!1})},862:function(e,t,r){var content=r(871);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(57).default)("0d16a966",content,!0,{sourceMap:!1})},863:function(e,t,r){var content=r(873);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(57).default)("56c34f47",content,!0,{sourceMap:!1})},864:function(e,t,r){"use strict";r.r(t);r(367);var n={props:{value:Object,rows:{type:Number,default:10}},data:function(){return{locales:{zh:"中文",en:"English"},content:{zh:"中文",en:"English"}}},created:function(){this.$system("locales")&&(this.locales=this.$copyObject(this.$system("locales").support)),this.value&&(this.content=this.value)},methods:{setLang:function(e){this.$emit("curLang",e)},cinput:function(){this.$emit("input",this.content)}},watch:{value:function(e){this.content=e}}},o=(r(868),r(55)),component=Object(o.a)(n,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-tabs",e._l(e.locales,(function(t,n,o){return r("b-tab",{key:"locale"+o,attrs:{title:t},on:{click:function(t){return e.setLang(n)}}},[r("b-textarea",{attrs:{rows:e.rows},on:{input:e.cinput},model:{value:e.content[n],callback:function(t){e.$set(e.content,n,t)},expression:"content[key]"}})],1)})),1)],1)}),[],!1,null,"05c43ddc",null);t.default=component.exports},868:function(e,t,r){"use strict";r(861)},869:function(e,t,r){(t=r(56)(!1)).push([e.i,"textarea[data-v-05c43ddc]{width:100%}",""]),e.exports=t},870:function(e,t,r){"use strict";r(862)},871:function(e,t,r){(t=r(56)(!1)).push([e.i,"[data-v-2398be4f] h1{color:#ff4500;font-size:110%;margin:12px 0 6px}",""]),e.exports=t},872:function(e,t,r){"use strict";r(863)},873:function(e,t,r){(t=r(56)(!1)).push([e.i,"[data-v-c90387ec] .itemList{margin:12px 0}.container-fluid[data-v-c90387ec]{margin-top:30px}.pdescription[data-v-c90387ec]{width:100%;height:300px}.titleLabel[data-v-c90387ec]{display:inline-block;width:100px;margin:0 16px 24px 0;text-align:right}[data-v-c90387ec] h1{color:#ff4500;font-size:110%;margin:12px 0 6px}",""]),e.exports=t},907:function(e,t,r){"use strict";r.r(t);r(30),r(49);var n=r(7),o=r(26),c={data:function(){return{name:"",candidates:{}}},methods:{selectUser:function(e,t){var r={id:e,name:t.name};this.$emit("getUser",r)},searchUser:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.name.length<2)){t.next=2;break}return t.abrupt("return");case 2:return r={},t.next=5,o.d.collection("users").where("name","==",e.name).get();case 5:if(!(n=t.sent).empty)for(i=0;i<n.docs.length;i++)c=n.docs[i],r[c.id]=c.data();e.candidates=r;case 8:case"end":return t.stop()}}),t)})))()}}},l=r(55),component=Object(l.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("p",{attrs:{align:"center"}},[e._v("User name: \n        "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"ml-2",domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),e._v(" "),r("button",{attrs:{size:"sm",variant:"success"},on:{click:e.searchUser}},[e._v("Search")])]),e._v(" "),e._l(e.candidates,(function(t,n,o){return r("p",{key:t.id,attrs:{align:"center"}},[e._v("\n        "+e._s(o+1)+". "),r("b-link",{on:{click:function(r){return e.selectUser(n,t)}}},[e._v(e._s(t.name)+" - "+e._s(t.email))])],1)}))],2)}),[],!1,null,null,null);t.default=component.exports},946:function(e,t,r){var content=r(1249);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(57).default)("337e214a",content,!0,{sourceMap:!1})}}]);