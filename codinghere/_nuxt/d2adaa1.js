(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{1123:function(e,t,r){"use strict";r.r(t);r(58),r(30),r(27),r(87),r(49);var n=r(7),o=r(855),c=r(26),l={data:function(){return{infoAlert:!1,info:{},siteNews:null,nocourse:!0,selected:null,showCodebox:!1,enterCode:null,teachCourses:{},assistCourses:{},selectCourses:{},otherCourses:{},courseLIST:{},cidToSelect:null,localeText:{UserCourse_NoCourse:"尚未選擇任何課程",UserCourse_NoNews:"沒有課程訊息"}}},computed:{ctitle:function(){if(this.cidToSelect&&this.courseLIST[this.cidToSelect])return this.courseLIST[this.cidToSelect].name}},created:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.localeText=e.$updateLocaleText(e.localeText),(r=e.$system("setting"))&&r.siteNews&&(e.siteNews=e.$copyObject(r.siteNews)),t.next=5,e.$store.dispatch("getCourse","LIST");case 5:n=t.sent,o=e.$user("courses"),n&&function(){var t=e.$user("id");for(var r in e.courseLIST=n,e.courseLIST){var c=e.courseLIST[r];c.teachers&&c.teachers.some((function(e){return e.id===t}))?e.$set(e.teachCourses,r,c):c.assistants&&c.assistants.some((function(e){return e.id===t}))?e.$set(e.assistCourses,r,c):o&&r in o?e.$set(e.selectCourses,r,c):e.$set(e.otherCourses,r,c)}}();case 8:case"end":return t.stop()}}),t)})))()},methods:{updateCoursesAll:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,i,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r={},n=["courses","teach","assist"],i=0;case 3:if(!(i<n.length)){t.next=20;break}if(o=n[i],!e.$user(o)){t.next=17;break}t.t0=regeneratorRuntime.keys(e.$user(o));case 7:if((t.t1=t.t0()).done){t.next=17;break}if("playground"!=(c=t.t1.value)){t.next=11;break}return t.abrupt("continue",7);case 11:if(r[c]){t.next=15;break}return t.next=14,e.$store.dispatch("getCourse",c);case 14:r[c]=t.sent;case 15:t.next=7;break;case 17:i++,t.next=3;break;case 20:e.coursesAll=r;case 21:case"end":return t.stop()}}),t)})))()},checkCode:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,l,d,f,v,h,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.cidToSelect)||!e.courseLIST[r]){t.next=5;break}l=e.courseLIST[r],t.next=6;break;case 5:return t.abrupt("return");case 6:if(l.enrollCode!==e.enterCode){t.next=34;break}return d={},e.$user("courses")&&(d=e.$copyObject(e.$user("courses"))),d[r]={name:l.name},t.next=12,c.d.collection("users").doc(e.$user("id")).update({courses:d,updated:o.a.getNow()});case 12:return e.$store.commit("setObjItem",{obj:"user",name:"courses",value:d}),f=e.$user(""),v=null,h=null,m=c.d.collection("courses").doc(r),t.prev=17,t.next=20,c.d.runTransaction(function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(r){var n,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.get(m);case 2:return n=t.sent,v=n.data(),c={},v.students&&(c=e.$copyObject(v.students)),c[f.id]||(c[f.id]={name:f.name,stdID:f.stdID}),h={students:c,updated:o.a.getNow()},t.next=10,r.update(m,h);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(17),console.log(t.t0);case 25:v.students=h.students,v.updated=h.updated,e.$store.commit("setObjItem",{obj:"courseCache",name:r,value:v}),e.$delete(e.otherCourses,r),e.$set(e.selectCourses,r,v),e.info={title:"加選課程",message:"成功！"},e.infoAlert=!0,t.next=36;break;case 34:e.info={title:"加選課程",message:"錯誤！"},e.infoAlert=!0;case 36:case"end":return t.stop()}}),t,null,[[17,22]])})))()},addNewCourse:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.cidToSelect=e,t.showCodebox=!0;case 2:case"end":return r.stop()}}),r)})))()}}},d=(r(919),r(55)),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-card",[r("b-modal",{attrs:{title:e.info.title},model:{value:e.infoAlert,callback:function(t){e.infoAlert=t},expression:"infoAlert"}},[e._v(e._s(e.info.message)+"\n    ")]),e._v(" "),r("div",{staticClass:"ml-3"},[r("h1",[e._v("系統訊息")]),e._v(" "),r("div",{domProps:{innerHTML:e._s(e.$md.render(e.$selectUserLocaleText(e.siteNews)))}})]),e._v(" "),Object.keys(e.teachCourses).length>0?r("div",{staticClass:"ml-3"},[r("h1",[e._v("教授課程")]),e._v(" "),e._l(e.teachCourses,(function(t,n,o){return r("div",{key:"t"+n},[r("span",{staticClass:"mr-2"},[e._v(e._s(o+1)+".")]),e._v(" "),r("b-link",{class:"text-"+t.variant,attrs:{to:"/teacher/"+n}},[e._v(e._s(t.name))])],1)}))],2):e._e(),e._v(" "),Object.keys(e.assistCourses).length>0?r("div",{staticClass:"ml-3"},[r("h1",[e._v("助教課程")]),e._v(" "),e._l(e.assistCourses,(function(t,n,o){return r("div",{key:"a"+n},[r("span",{staticClass:"mr-2"},[e._v(e._s(o+1)+".")]),e._v(" "),r("b-link",{class:"text-"+t.variant,attrs:{to:"/teacher/"+n}},[e._v(e._s(t.name))])],1)}))],2):e._e(),e._v(" "),Object.keys(e.selectCourses).length>0?r("div",{staticClass:"ml-3"},[r("h1",[e._v("已修課程")]),e._v(" "),e._l(e.selectCourses,(function(t,n,o){return r("div",{key:"s"+n},[r("span",{staticClass:"mr-2"},[e._v(e._s(o+1)+".")]),e._v(" "),r("b-link",{class:"text-"+t.variant,attrs:{to:"/user/records"}},[e._v(e._s(t.name))])],1)}))],2):e._e(),e._v(" "),Object.keys(e.otherCourses).length>0?r("div",{staticClass:"ml-3"},[r("h1",[e._v("可選課程")]),e._v(" "),e._l(e.otherCourses,(function(t,n,o){return r("div",{key:"o"+n},[r("span",{staticClass:"mr-2"},[e._v(e._s(o+1)+".")]),e._v(" "),r("b-link",{class:"text-"+t.variant,on:{click:function(t){return e.addNewCourse(n)}}},[e._v(e._s(t.name))])],1)}))],2):e._e(),e._v(" "),r("b-modal",{attrs:{size:"lg",title:e.ctitle},on:{ok:e.checkCode},model:{value:e.showCodebox,callback:function(t){e.showCodebox=t},expression:"showCodebox"}},[r("p",[e._v("輸入課程代碼")]),e._v(" "),r("b-input",{staticClass:"mr-3",attrs:{size:"sm",type:"text",placeholder:"Enroll Code"},model:{value:e.enterCode,callback:function(t){e.enterCode=t},expression:"enterCode"}})],1)],1)}),[],!1,null,"12f3708c",null);t.default=component.exports},855:function(e,t,r){"use strict";r(10),r(14),r(22),r(86),r(9),r(856),r(29),r(15);var n=r(228),o=r.n(n),c={pad:function(e){return("0"+e).slice(-2)},mmss:function(e){var t=Math.floor(e/60);return e%=60,"".concat(this.pad(t),":").concat(this.pad(e))},hhmmss:function(e){var t=Math.floor(e/60);e%=60;var r=Math.floor(t/60);return t%=60,"".concat(this.pad(r),":").concat(this.pad(t),":").concat(this.pad(e))},getToday:function(){var e=new Date,dd=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0");return e.getFullYear()+t+dd},getNow:function(){var e=new Date;return""+e.getFullYear()+this.pad(e.getMonth()+1)+this.pad(e.getDate())+this.pad(e.getHours())+this.pad(e.getMinutes())+this.pad(e.getSeconds())},obj2arr:function(e){var t=[],r=Object.keys(e);return r.sort(),r.forEach((function(r){t.push(Object.assign({id:r},e[r]))})),t},arr2obj:function(e){var t={};return e.forEach((function(e){var r=JSON.parse(JSON.stringify(e)),n=e.id;delete r.id,t[n]=r})),t},getOptions:function(e){var t=[];return e.split("#@@#").forEach((function(e){var s=e.split("#@");t.push({text:s[0],value:s[1]})})),t},findIdPos:function(e,t){if(!e)return-1;for(var r=0;r<e.length;r++)if(t==e[r].id)return r;return-1},encode:function(e,t){return new o.a(e).encrypt(t)},decode:function(e,t){return new o.a(e).decrypt(t)}};t.a=c},856:function(e,t,r){"use strict";var n=r(8),o=r(857).start;n({target:"String",proto:!0,forced:r(858)},{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},857:function(e,t,r){var n=r(50),o=r(229),c=r(52),l=Math.ceil,d=function(e){return function(t,r,d){var f,v,h=String(c(t)),m=h.length,x=void 0===d?" ":String(d),_=n(r);return _<=m||""==x?h:(f=_-m,(v=o.call(x,l(f/x.length))).length>f&&(v=v.slice(0,f)),e?h+v:v+h)}};e.exports={start:d(!1),end:d(!0)}},858:function(e,t,r){var n=r(127);e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},905:function(e,t,r){var content=r(920);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(57).default)("2c0a73e4",content,!0,{sourceMap:!1})},919:function(e,t,r){"use strict";r(905)},920:function(e,t,r){(t=r(56)(!1)).push([e.i,'.container-fluid[data-v-12f3708c]{padding:24px 24px 80px;position:relative;margin:0}[data-v-12f3708c] h1{color:#00f;font-family:"Arial";margin:32px 12px 12px -20px;border-bottom:1px solid #00f;padding-bottom:3px}[data-v-12f3708c] h1,[data-v-12f3708c] h2{font-size:100%}[data-v-12f3708c] h2{color:#ff4500;margin:16px 0 8px}',""]),e.exports=t}}]);