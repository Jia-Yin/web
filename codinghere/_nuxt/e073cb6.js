(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1149:function(e,t,r){var content=r(1350);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(58).default)("2cf54b0b",content,!0,{sourceMap:!1})},1349:function(e,t,r){"use strict";r(1149)},1350:function(e,t,r){(t=r(57)(!1)).push([e.i,"[data-v-2ebd458a] table td{padding:6px}.container-fluid[data-v-2ebd458a]{margin-top:30px}.pdescription[data-v-2ebd458a]{width:100%;height:300px}.titleLabel[data-v-2ebd458a]{width:100px;margin:0 16px 24px 0;text-align:right}.titleLabel[data-v-2ebd458a],[data-v-2ebd458a] h1{display:inline-block}[data-v-2ebd458a] h1{color:#ff4500;font-size:110%;margin:12px 0 6px}",""]),e.exports=t},1598:function(e,t,r){"use strict";r.r(t);r(160),r(26),r(9),r(42),r(80),r(885),r(20),r(29),r(46),r(88),r(381),r(49);var o=r(7),n=r(27),l=r(1102),c=r(884),d=(r(905),r(903)),m=r(920),f={components:{ProblemEditor:l.default,ProblemTable:d.default,ProblemSelector:m.default},asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$content,t.next=3,r("playground").fetch();case 3:return o=t.sent,t.abrupt("return",{playground:o});case 5:case"end":return t.stop()}}),t)})))()},data:function(){return{editMode:!1,problemTab:0,pgKey:"CHProblem",lastPID:0,problems:[],pgproblems:[],pgselected:null,psselected:null,pmText:"新增",infoAlert:!1,info:{title:"",message:""},problem:{title:null,description:null,answerLang:"c",answerCode:"",dataLang:"py",dataCode:"",cmpMode:null,timeLimit:null,memoryLimit:null,outputLimit:null,tags:""},localeText:{AdminProblem_Playground:"練習廣場",AdminProblem_ProbEdit:"題目編修",AdminProblem_ProbList:"題庫管理",Common_Edit:"編輯",Common_Copy:"複製"}}},created:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o,l,d,i,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.localeText=e.$updateLocaleText(e.localeText),t.next=3,n.d.collection("problems").doc("BASE").get();case 3:if((r=t.sent).exists&&(o=r.data(),e.problems=c.a.obj2arr(o),e.lastPID=e.problems.length),e.playground)for(l=e.playground.DATA,d=c.a.decode(e.pgKey,l),i=0;i<d.length;i++)(m=c.a.findIdPos(e.problems,d[i].id))>=0&&e.pgproblems.push(e.problems[m]);case 6:case"end":return t.stop()}}),t)})))()},mounted:function(){},methods:{selectDone:function(e){this.unitForm.probs=e,this.selUnitProb=!1},openDataFunc:function(){var e=this.$router.resolve({path:"/admin/datafunc"});window.open(e.href,"_blank")},pmReset:function(){this.editMode=!1,this.pmText="新增"},updateProblem:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var o,l,d,m,f,h,v,x;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.d.collection("problems").doc("BASE").get();case 2:if(o=r.sent,l=o.data(),o.exists?(t.problems=c.a.obj2arr(l),t.lastPID=t.problems.length):(t.problems=[],t.lastPID=0),!t.editMode){r.next=17;break}return d=t.$copyObject(e),d=t.copyAndTags2Arr(d),(m=c.a.findIdPos(t.problems,d.id))>=0&&t.problems.splice(m,1,d),f=c.a.arr2obj(t.problems),r.next=13,n.d.collection("problems").doc("BASE").set(f);case 13:t.infoAlert=!0,t.info={title:"Update",message:"OK"},r.next=28;break;case 17:return t.lastPID+=1,h="BASE"+t.lastPID.toString().padStart(3,"0"),(v=t.$copyObject(e)).id=h,v=t.copyAndTags2Arr(v),t.problems.push(v),x=c.a.arr2obj(t.problems),r.next=26,n.d.collection("problems").doc("BASE").set(x);case 26:t.infoAlert=!0,t.info={title:"Create",message:"OK"};case 28:case"end":return r.stop()}}),r)})))()},copyProblem:function(e){this.problem=e,this.editMode=!1,this.pmText="新增",this.problemTab=2},editProblem:function(e){this.problem=e,this.editMode=!0,this.pmText="更新",this.problemTab=2},copyAndTags2Arr:function(e){var t=this.$copyObject(e);if(t.tags&&!(t.tags instanceof Array)){var r=t.tags.trim();r.length>0?(r=r.replace(/,/g," "),t.tags=r.split(/\s+/)):delete t.tags}return t},PGProblemGenerate:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var i,o,n,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(i=0;i<e.length;i++)delete t.problems[i]._showDetails,delete t.problems[i].tags;o='{\n    "KEY": "'+t.pgKey+'",\n    "DATA": "'+c.a.encode(t.pgKey,JSON.stringify(t.pgproblems))+'"\n}',"playground.json",n=new Blob([o],{type:"text/plain;charset=utf-8"}),window.navigator.msSaveOrOpenBlob?window.navigator.msSaveBlob(n,"playground.json"):((l=window.document.createElement("a")).href=window.URL.createObjectURL(n),l.download="playground.json",document.body.appendChild(l),l.click(),document.body.removeChild(l));case 5:case"end":return r.stop()}}),r)})))()}}},h=(r(1349),r(56)),component=Object(h.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{attrs:{fluid:""}},[r("b-modal",{attrs:{title:e.info.title},model:{value:e.infoAlert,callback:function(t){e.infoAlert=t},expression:"infoAlert"}},[e._v(e._s(e.info.message))]),e._v(" "),r("b-tabs",{attrs:{"content-class":"mt-3"},model:{value:e.problemTab,callback:function(t){e.problemTab=t},expression:"problemTab"}},["admin"==e.$user("role")?r("b-tab",{attrs:{title:e.localeText.AdminProblem_Playground}},[r("problem-selector",{attrs:{oriProblems:e.problems,selProblems:e.pgproblems,selText:"Playground",OKText:"Generate"},on:{OK:e.PGProblemGenerate}}),e._v(" "),r("hr")],1):e._e(),e._v(" "),r("b-tab",{attrs:{title:e.localeText.AdminProblem_ProbList}},[r("h1",{staticClass:"mb-3"},[e._v("Set = BASE")]),e._v(" "),e.problems.length>0?r("problem-table",{attrs:{problems:e.problems,showID:"",showFilter:"",showDetail:"",editProblem:e.editProblem,copyProblem:e.copyProblem}}):r("div",[r("p",[e._v("Currently there is no problems.")])])],1),e._v(" "),r("b-tab",{attrs:{title:e.localeText.AdminProblem_ProbEdit}},[r("div",{staticClass:"mb-3 d-flex justify-content-between"},[r("h1",[e._v("Set = BASE")]),e._v(" "),r("b-button",{attrs:{flex:"",size:"sm",variant:"success"},on:{click:e.openDataFunc}},[e._v("DOC")])],1),e._v(" "),r("problem-editor",{attrs:{problem:e.problem,okText:e.pmText},on:{OK:e.updateProblem,Reset:e.pmReset}})],1)],1)],1)}),[],!1,null,"2ebd458a",null);t.default=component.exports;installComponents(component,{ProblemSelector:r(920).default,ProblemTable:r(903).default,ProblemEditor:r(1102).default})}}]);