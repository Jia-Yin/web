(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1268:function(t,e,r){"use strict";r(953)},1269:function(t,e,r){(e=r(56)(!1)).push([t.i,'[data-v-0de2e9fe] h1{color:#00f;font-family:"Arial";font-size:120%;margin:24px 0}[data-v-0de2e9fe] h2{color:#ff4500;font-size:100%;margin:16px 0 8px}',""]),t.exports=e},1405:function(t,e,r){"use strict";r.r(e);r(10),r(156),r(9),r(157),r(29),r(49);var n=r(7),o=r(855),l=r(26),c={data:function(){return{showDeleteConfirm:!1,infoAlert:!1,info:{title:"",message:""},rules:[],todel:{},ruleToTest:{},errMsg:"",showTest:!1,fields:[{key:"id",sortable:!0},{key:"title",label:"Title",sortable:!0},{key:"inerror",label:"In Error",sortable:!0},{key:"pattern",label:"Pattern",sortable:!1},{key:"argc",label:"Params #",sortable:!0},{key:"msg",label:"Message",sortable:!1},{key:"actions"}],localeText:{DataMan_SynErrorTitle:"語法錯誤規則",DataMan_SynErrorTest:"測試",SYS_Export:"匯出",SYS_Import:"匯入",SYS_New:"新建",SYS_Delete:"刪除"}}},created:function(){this.localeText=this.$updateLocaleText(this.localeText);var t=this.$system("setting"),e=t&&t.synRules||{};this.rules=o.a.obj2arr(e)},methods:{hintMessage:function(t){for(var e=this.errMsg.split("\n"),r=0;r<e.length;r++){var n=e[r],o=null,l=null,c=n.match(/(\d+):(\d+):(.*)error/);c&&(o=c[1],l=c[2]);var d=this.ruleToTest;if(!d.inerror||c){var f=n.match(d.pattern);if(f){var title=d.title,desc=this.$selectUserLocaleText(d.msg).replaceAll("LINE",o);desc=desc.replaceAll("POS",l);for(var v=1;v<=d.argc;v++){var h="@@"+v;desc=desc.replaceAll(h,f[v]),title=title.replaceAll(h,f[v])}return"## ".concat(title,"\n").concat(desc)}}}return"No match!"},showMsg:function(t){return this.$selectUserLocaleText(t).substring(0,30)+"..."},testrule:function(t){this.ruleToTest=t,this.showTest=!0},deleterule:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!((r=o.a.findIdPos(t.rules,t.todel.id))<0)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,l.d.collection("system").doc("setting").get();case 6:return n=e.sent,c=n.data(),delete(d=c.synRules||{})[t.todel.id],c.synRules=d,c.updated=o.a.getNow(),e.next=14,l.d.collection("system").doc("setting").update({synRules:d,updated:o.a.getNow()});case 14:t.rules.splice(r,1),t.$store.commit("setObjItem",{obj:"system",name:"setting",value:c}),t.info={title:"Delete Rule",message:"OK"},t.infoAlert=!0,e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.log("Error",e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))()},deleteconfirm:function(t){this.todel=t,this.showDeleteConfirm=!0}}},d=(r(1268),r(55)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-modal",{attrs:{title:t.info.title},model:{value:t.infoAlert,callback:function(e){t.infoAlert=e},expression:"infoAlert"}},[t._v(t._s(t.info.message)+"\n    ")]),t._v(" "),r("b-modal",{attrs:{title:t.localeText.SYS_Delete},on:{ok:function(e){return t.deleterule()}},model:{value:t.showDeleteConfirm,callback:function(e){t.showDeleteConfirm=e},expression:"showDeleteConfirm"}},[r("p",{staticClass:"my-4"},[t._v(t._s(t.todel&&t.todel.title))])]),t._v(" "),r("b-modal",{attrs:{size:"xl",title:t.localeText.DataMan_SynErrorTest,"hide-footer":""},model:{value:t.showTest,callback:function(e){t.showTest=e},expression:"showTest"}},[r("h1",[t._v("Error Message:")]),t._v(" "),r("b-textarea",{attrs:{rows:5},model:{value:t.errMsg,callback:function(e){t.errMsg=e},expression:"errMsg"}}),t._v(" "),r("h1",[t._v("Hint Message:")]),t._v(" "),r("div",{domProps:{innerHTML:t._s(t.$md.render(t.hintMessage(t.errMsg)))}})],1),t._v(" "),r("h1",[t._v(t._s(t.localeText.DataMan_SynErrorTitle)+"\n        "),r("b-button",{staticClass:"ml-3",attrs:{size:"sm",variant:"success"}},[t._v(t._s(t.localeText.SYS_Export))]),t._v(" "),r("b-button",{staticClass:"ml-3",attrs:{size:"sm",variant:"success"}},[t._v(t._s(t.localeText.SYS_Import))]),t._v(" "),r("b-button",{staticClass:"ml-3",attrs:{size:"sm",variant:"success",to:"/admin/dataman/synerror/create"}},[t._v(t._s(t.localeText.SYS_New))])],1),t._v(" "),r("b-table",{attrs:{items:t.rules,fields:t.fields},scopedSlots:t._u([{key:"cell(msg)",fn:function(data){return[r("span",{domProps:{innerHTML:t._s(t.showMsg(data.value))}})]}},{key:"cell(actions)",fn:function(e){return[r("b-button-group",[r("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t.localeText.SYS_Test,size:"sm",variant:"outline-primary"},on:{click:function(r){return t.testrule(e.item)}}},[r("b-icon",{attrs:{icon:"check"}})],1),t._v(" "),r("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t.localeText.SYS_Edit,size:"sm",variant:"outline-primary",to:"/admin/dataman/synerror/edit?id="+e.item.id}},[r("b-icon",{attrs:{icon:"pen"}})],1),t._v(" "),r("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:t.localeText.SYS_Delete,size:"sm",variant:"outline-primary"},on:{click:function(r){return t.deleteconfirm(e.item)}}},[r("b-icon",{attrs:{icon:"trash"}})],1)],1)]}}])})],1)}),[],!1,null,"0de2e9fe",null);e.default=component.exports},855:function(t,e,r){"use strict";r(10),r(14),r(86),r(9),r(856),r(29),r(15);var n=r(228),o=r.n(n),l={pad:function(t){return t<10?"0"+t:t},mmss:function(t){var e=Math.floor(t/60);return t%=60,"".concat(this.pad(e),":").concat(this.pad(t))},hhmmss:function(t){var e=Math.floor(t/60);t%=60;var r=Math.floor(e/60);return e%=60,"".concat(this.pad(r),":").concat(this.pad(e),":").concat(this.pad(t))},getToday:function(){var t=new Date,dd=String(t.getDate()).padStart(2,"0"),e=String(t.getMonth()+1).padStart(2,"0");return t.getFullYear()+e+dd},getNow:function(){var t=new Date;return""+t.getFullYear()+this.pad(t.getMonth()+1)+this.pad(t.getDate())+this.pad(t.getHours())+this.pad(t.getMinutes())+this.pad(t.getSeconds())},obj2arr:function(t){var e=[],r=Object.keys(t);return r.sort(),r.forEach((function(r){e.push(Object.assign({id:r},t[r]))})),e},arr2obj:function(t){var e={};return t.forEach((function(t){var r=JSON.parse(JSON.stringify(t)),n=t.id;delete r.id,e[n]=r})),e},getOptions:function(t){var e=[];return t.split("#@@#").forEach((function(t){var s=t.split("#@");e.push({text:s[0],value:s[1]})})),e},findIdPos:function(t,e){if(!t)return-1;for(var r=0;r<t.length;r++)if(e==t[r].id)return r;return-1},encode:function(t,e){return new o.a(t).encrypt(e)},decode:function(t,e){return new o.a(t).decrypt(e)}};e.a=l},856:function(t,e,r){"use strict";var n=r(8),o=r(857).start;n({target:"String",proto:!0,forced:r(858)},{padStart:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},857:function(t,e,r){var n=r(50),o=r(229),l=r(52),c=Math.ceil,d=function(t){return function(e,r,d){var f,v,h=String(l(e)),m=h.length,_=void 0===d?" ":String(d),S=n(r);return S<=m||""==_?h:(f=S-m,(v=o.call(_,c(f/_.length))).length>f&&(v=v.slice(0,f)),t?h+v:v+h)}};t.exports={start:d(!1),end:d(!0)}},858:function(t,e,r){var n=r(127);t.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},953:function(t,e,r){var content=r(1269);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(57).default)("45cbf2e6",content,!0,{sourceMap:!1})}}]);