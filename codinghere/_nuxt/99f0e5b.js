(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1297:function(t,e,n){"use strict";n.r(e);n(29),n(49);var r=n(8),o=(n(899),n(867)),c=n(32),d=n(844),l={components:{ProgTest:o.default},data:function(){return{reExam:!1,time:10,index:0,totalScore:0,skip:!1,finished:!1,problems:[],exam:null,record:{userid:null,examid:null,courseid:null,date:null,submits:{},score:0},recordId:null}},computed:{ready:function(){return this.problems&&this.problems.length>0},tick:function(){return this.$store.state.params.tick},eid:function(){return this.$route.params.eid},cid:function(){return this.$route.params.course}},created:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.d.collection("exams").doc(t.eid).get();case 2:n=e.sent,r=n.data(),t.exam=r,t.setExam();case 6:case"end":return e.stop()}}),e)})))()},methods:{skipproblem:function(){this.skip=!0},submit:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.correct&&(e.totalScore+=e.problems[e.index].score),e.record.submits[e.problems[e.index].id]=t,e.record.score=e.totalScore,console.log("Record",e.record),e.skip=!1,!e.finished&&e.index<e.problems.length-1?e.index++:e.leave();case 6:case"end":return n.stop()}}),n)})))()},setExam:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.$copyObject(t.exam.probs)).sort((function(t,e){return t.order-e.order!=0?t.order-e.order:Math.random()-.5})),t.time=60*t.exam.tlimit,t.problems=n,t.record.userid=t.$user("id"),t.record.examid=t.eid,t.record.examname=t.exam.name,t.record.courseid=t.cid,t.record.date=d.a.getToday(),t.record.finish=!1;case 10:case"end":return e.stop()}}),e)})))()},leave:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.record.spentTime=60*t.exam.tlimit-t.time,console.log("Final Record",t.record),t.$router.push("/admin/".concat(t.cid,"/exams/"));case 3:case"end":return e.stop()}}),e)})))()},mmss:function(t){return d.a.mmss(t)},hhmmss:function(t){return d.a.hhmmss(t)}},watch:{tick:function(t){this.time--,0===this.time&&this.leave()}}},m=n(55),component=Object(m.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",[n("b-navbar",{attrs:{variant:"light"}},[n("b-navbar-nav",{staticClass:"mr-auto"},[n("b-nav-text",{staticClass:"text-dark"},[t._v(t._s(t.$user("name")))])],1),t._v(" "),n("b-navbar-nav",{staticClass:"mr-auto"},[n("b-nav-text",{staticClass:"text-primary"},[t._v("\n                總分 "+t._s(t.exam&&t.exam.tscore)+"，限時\n                "+t._s(t.exam&&t.exam.tlimit)+" 分鐘；   本題佔分\n                "+t._s(t.problems[t.index]&&t.problems[t.index].score)+"， 限時\n                "+t._s(t.problems[t.index]&&t.mmss(t.problems[t.index].tlimit))+"\n                   剩餘考試時間 "+t._s(t.hhmmss(t.time))+"\n            ")])],1),t._v(" "),n("b-navbar-nav",{staticClass:"mr-auto"},[t.skip?t._e():n("b-button",{staticClass:"ml-3 btn-sm btn-outline-success",attrs:{variant:"outline-success"},on:{click:function(e){return t.skipproblem()}}},[t._v("跳過本題")]),t._v(" "),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-leave",modifiers:{"modal-leave":!0}}],staticClass:"ml-3 btn btn-sm btn-outline-danger",attrs:{variant:"outline-danger"}},[t._v("離開考場")]),t._v(" "),n("b-modal",{attrs:{id:"modal-leave",title:"溫馨提醒","ok-title":"確定","cancel-title":"取消","no-close-on-esc":!0,"no-close-on-backdrop":!0},on:{ok:function(e){return t.leave()}}},[n("p",{staticClass:"mt-4 text-danger"},[t._v("此視窗顯示時，計時不會暫停。")]),t._v(" "),n("p",{staticClass:"my-4 text-danger"},[t._v("\n                    離開考場等於交卷，不得再次進入！\n                    "),n("br"),t._v("確定要離開嗎？\n                ")])])],1),t._v(" "),n("b-navbar-nav",[n("b-nav-text",{staticClass:"text-dark"},[t._v(t._s(t.index+1)+" /\n                "+t._s(t.problems&&t.problems.length))])],1)],1),t._v(" "),t.ready&&"progtest"==t.problems[t.index].type?n("ProgTest",{key:t.index,attrs:{times:t.problems[t.index].tlimit,quiz:t.problems[t.index],submit:t.submit,skip:t.skip}}):t._e()],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{ProgTest:n(867).default})},844:function(t,e,n){"use strict";n(10),n(14),n(22),n(103),n(9),n(845),n(27),n(15);var r=n(227),o=n.n(r),c={pad:function(t){return("0"+t).slice(-2)},mmss:function(t){var e=Math.floor(t/60);return t%=60,"".concat(this.pad(e),":").concat(this.pad(t))},hhmmss:function(t){var e=Math.floor(t/60);t%=60;var n=Math.floor(e/60);return e%=60,"".concat(this.pad(n),":").concat(this.pad(e),":").concat(this.pad(t))},getToday:function(){var t=new Date,dd=String(t.getDate()).padStart(2,"0"),e=String(t.getMonth()+1).padStart(2,"0");return t.getFullYear()+e+dd},getNow:function(){var t=new Date;return""+t.getFullYear()+this.pad(t.getMonth()+1)+this.pad(t.getDate())+this.pad(t.getHours())+this.pad(t.getMinutes())+this.pad(t.getSeconds())},obj2arr:function(t){var e=[],n=Object.keys(t);return n.sort(),n.forEach((function(n){e.push(Object.assign({id:n},t[n]))})),e},arr2obj:function(t){var e={};return t.forEach((function(t){var n=JSON.parse(JSON.stringify(t)),r=t.id;delete n.id,e[r]=n})),e},getOptions:function(t){var e=[];return t.split("#@@#").forEach((function(t){var s=t.split("#@");e.push({text:s[0],value:s[1]})})),e},findIdPos:function(t,e){if(!t)return-1;for(var n=0;n<t.length;n++)if(e==t[n].id)return n;return-1},encode:function(t,e){return new o.a(t).encrypt(e)},decode:function(t,e){return new o.a(t).decrypt(e)}};e.a=c},866:function(t,e,n){var content=n(874);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(61).default)("2e95a49a",content,!0,{sourceMap:!1})},867:function(t,e,n){"use strict";n.r(e);n(365),n(49);var r=n(8),o=n(844),c=n(852),d=n(32),l={components:{ProblemSolver:c.default},props:{quiz:Object,submit:Function,times:{type:Number,default:300},skip:{type:Boolean,default:!1},lang:{type:String,default:"c"},langs:{type:String,default:"c, cpp, py"},initcode:{type:String,default:""},correctHint:{type:String,default:"正確，提交並進下一題"}},data:function(){return{lastcode:{sourceLang:"c",sourceCode:""},showPass:!1,mycode:"",codelang:"c",channel:null,chnlabel:"None",time:0,timer:null,timing:!0,spendTime:0,result:null,judging:!1,submitResult:null,pass:!1,done:!1}},computed:{tick:function(){return this.$store.state.params.tick}},created:function(){this.mycode=this.initcode,this.codelang=this.lang},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0==t.times?t.timing=!1:t.time=t.times;case 1:case"end":return e.stop()}}),e)})))()},methods:{isubmit:function(data){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=data.cdata,r=data.result,n.sourceLang==t.lastcode.sourceLang&&n.sourceCode==t.lastcode.sourceCode){e.next=9;break}return t.lastcode={sourceLang:n.sourceLang,sourceCode:n.sourceCode},c={uid:t.$user("id"),pid:t.quiz.id,created:o.a.getNow(),lang:n.sourceLang,code:n.sourceCode,status:r.RunStatus,score:r.Score},e.next=7,d.d.collection("submits").add(c);case 7:l=e.sent,c.id=l.id;case 9:"AC"===r.RunStatus&&(t.spendTime=t.timing?t.times-t.time:0,t.showPass=!0);case 10:case"end":return e.stop()}}),e)})))()},setLang:function(t){this.codelang=t},mmss:function(t){return o.a.mmss(t)},send:function(t){this.showPass||(this.spendTime=this.timing?this.times-this.time:0),this.showPass=!1,this.done=!0,this.judging=!1,this.submit({correct:t,uans:this.lastcode.sourceCode,usetime:this.spendTime,lang:this.lastcode.sourceLang})}},watch:{tick:function(t){this.time>0&&this.time--,0===this.time&&this.send(!1)},skip:function(t){console.log("V",t),t&&!this.done&&this.send(!1)}}},m=(n(873),n(55)),component=Object(m.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"qpanel"},[n("b-modal",{attrs:{centered:"",title:"通過測試","hide-footer":""},model:{value:t.showPass,callback:function(e){t.showPass=e},expression:"showPass"}},[n("p",{attrs:{align:"center"}},[n("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.send(!0)}}},[t._v("下一題")])],1)]),t._v(" "),n("p",{staticClass:"timestatus"},[n("span",{staticClass:"type"},[t._v("《程式題》")]),t._v(" "),t.timing?n("span",[t._v("倒數計時 "+t._s(t.mmss(t.time)))]):n("span",[t._v("靜態測試")])]),t._v(" "),n("problem-solver",{attrs:{problem:t.quiz,lang:t.lang,langs:t.langs},on:{submit:t.isubmit}})],1)}),[],!1,null,"16ce9334",null);e.default=component.exports;installComponents(component,{ProblemSolver:n(852).default})},873:function(t,e,n){"use strict";n(866)},874:function(t,e,n){(e=n(60)(!1)).push([t.i,".tcenter[data-v-16ce9334]{text-align:center}.type[data-v-16ce9334]{color:#ff0}.qpanel[data-v-16ce9334]{background:#eee;padding:24px}.timestatus[data-v-16ce9334]{background:#00f;color:#fff;text-align:center}.result[data-v-16ce9334]{position:fixed;left:25%;top:25%;width:50%;height:50%;background:#ddd;z-index:100;padding:24px;border:2px solid green;overflow-y:scroll}",""]),t.exports=e}}]);