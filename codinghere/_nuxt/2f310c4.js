(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{1114:function(e,t,r){var content=r(1320);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(57).default)("4430fb9f",content,!0,{sourceMap:!1})},1319:function(e,t,r){"use strict";r(1114)},1320:function(e,t,r){(t=r(56)(!1)).push([e.i,".rightBox[data-v-04f519b4]{position:absolute;right:32px;top:14px;width:120px}.tabs[data-v-04f519b4]{margin-right:60px}.container-fluid[data-v-04f519b4]{position:relative;margin:0;padding:0}",""]),e.exports=t},1404:function(e,t,r){"use strict";r.r(t);r(39),r(156),r(30),r(49);var n=r(7),o=r(855),c=r(865),d=r(26),l={components:{ProblemSolver:c.default},asyncData:function(e){return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.store,n=r.state.params.probSet,t.abrupt("return",{probSet:n});case 3:case"end":return t.stop()}}),t)})))()},data:function(){return{submitid:"",submitList:null,problem:null,baseProblems:null,demo:!1,pgKey:"Coding",lang:"c",langs:"c,cpp,py",initCode:"",lastcode:{},localeText:{Coding_Problem:"問題",Coding_Code:"程式",Coding_Result:"結果",Coding_Reference:"參考"}}},computed:{teaching:function(){var e=this.$user("role");return"teacher"==e||"assistant"==e}},created:function(){this.localeText=this.$updateLocaleText(this.localeText),this.problem=o.a.decode(this.pgKey,this.probSet.problem),this.probSet.initCode&&(this.initCode=this.probSet.initCode.code,this.lang=this.probSet.initCode.lang,this.lastcode={sourceLang:this.lang,sourceCode:this.initCode}),this.probSet.demo&&(this.demo=!0)},methods:{getBaseProblems:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.baseProblems){t.next=5;break}return t.next=3,d.d.collection("problems").doc("BASE").get();case 3:r=t.sent,e.baseProblems=r.data();case 5:case"end":return t.stop()}}),t)})))()},doSubmit:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.problem=e.problem,t.lang=e.lang,t.initCode="",t.$nextTick((function(){t.initCode=e.code})),t.demo=!0;case 5:case"end":return r.stop()}}),r)})))()},searchSubmit:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,c,l,m,f,i,h,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((r=e.submitid.length)<4)){t.next=4;break}return alert("Code should have 4 chars!"),t.abrupt("return");case 4:return n=e.submitid.charCodeAt(r-1),o=e.submitid.substr(0,r-1)+String.fromCharCode(n+1),t.next=8,d.d.collection("submits").where(d.b.firestore.FieldPath.documentId(),">",e.submitid).where(d.b.firestore.FieldPath.documentId(),"<",o).get();case 8:if(!(c=t.sent).empty){t.next=12;break}return alert("No Match Results!"),t.abrupt("return");case 12:return l=c.docs,t.next=15,e.getBaseProblems();case 15:if(1!=l.length){t.next=20;break}return(m=l[0].data()).problem=e.baseProblems[m.pid],e.doSubmit(m),t.abrupt("return");case 20:f=[],i=0;case 22:if(!(i<l.length)){t.next=33;break}return(h=l[i].data()).problem=e.baseProblems[h.pid],t.next=27,d.d.collection("users").doc(h.uid).get();case 27:x=t.sent,h.user=x.data(),f.push(h);case 30:i++,t.next=22;break;case 33:e.submitList=f;case 34:case"end":return t.stop()}}),t)})))()},submit:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,c,l,m,f,h,x,v,S,k,w,C,T,y,i,O,P,$,_,j,u,L,R,M,z,N,D;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.cdata,c=e.result,n.sourceLang!==t.lastcode.sourceLang||n.sourceCode!==t.lastcode.sourceCode){r.next=3;break}return r.abrupt("return");case 3:if(t.lastcode={sourceLang:n.sourceLang,sourceCode:n.sourceCode},l=t.probSet.courseID,m={uid:t.$user("id"),pid:t.problem.id,cid:l,created:o.a.getNow(),lang:n.sourceLang,code:n.sourceCode,status:c.RunStatus,score:c.Score},!t.demo){r.next=9;break}return console.log("DEMO"),r.abrupt("return");case 9:return r.next=11,d.d.collection("submits").add(m);case 11:return f=r.sent,m.id=f.id,h=t.$user("id"),r.next=16,d.d.collection("users").doc(h).get();case 16:if(x=r.sent,(v=x.data()).id=h,t.$store.commit("setData",{name:"user",value:v}),S={},t.$user("courses")&&(S=t.$copyObject(t.$user("courses"))),S[l]&&S[l].units||(S[l]={name:t.probSet.courseName,units:{}}),S[l].units[t.probSet.courseUnit]||(S[l].units[t.probSet.courseUnit]={score:0,TS:0,TP:0,probs:{}}),k=S[l].units[t.probSet.courseUnit],(w=k.probs[m.pid])?C=t.$copyObject(w):(C={title:t.problem.title,TS:0,TP:0,score:0,last10:[]},k.probs[m.pid]=C),k.TS+=1,C.TS+=1,T="0/","AC"==m.status&&(k.TP+=1,C.TP+=1,T="1/"),!t.probSet.practice&&m.score>C.score&&(k.score+=m.score-C.score,C.score=m.score),C.last10.splice(0,0,T+m.id),!(C.last10.length>10)){r.next=48;break}if(!(C.last10[10].indexOf("1/")>=0)){r.next=47;break}y=!0,i=0;case 37:if(!(i<10)){r.next=44;break}if(!(C.last10[i].indexOf("1/")>=0)){r.next=41;break}return y=!1,r.abrupt("break",44);case 41:i++,r.next=37;break;case 44:y?C.last10.splice(9,1):C.last10.splice(10,1),r.next=48;break;case 47:C.last10.splice(10,1);case 48:return k.probs[m.pid]=C,r.next=51,d.d.collection("users").doc(t.$user("id")).update({courses:S,updated:o.a.getNow()});case 51:if(t.$store.commit("setObjItem",{obj:"user",name:"courses",value:S}),!t.probSet.practice){r.next=54;break}return r.abrupt("return");case 54:if("playground"===l){r.next=68;break}return r.next=57,t.$store.dispatch("getCourseT",l);case 57:for(O=r.sent,P=O.units,$={},O.scores&&($=t.$copyObject(O.scores)),_=[],j=S[l].units,u=0;u<P.length;u++)L=P[u].name,j[L]?_.push(j[L].score):_.push(0);return $[m.uid]=_,R={scores:$,updated:o.a.getNow()},r.next=68,t.$store.dispatch("updateCourse",{id:l,value:R});case 68:return r.next=70,d.d.collection("problems").doc("STAT").get();case 70:if((M=r.sent).exists){r.next=78;break}return z={updated:o.a.getNow()},r.next=75,d.d.collection("problems").doc("STAT").set(z);case 75:N=z,r.next=80;break;case 78:(N=M.data()).updated=o.a.getNow();case 80:return D=t.problem.id,N[D]||(N[D]={TS:0,TP:0}),N[D].TS+=1,c.Score>90&&"AC"==m.status&&(N[D].TP+=1),r.next=86,d.d.collection("problems").doc("STAT").set(N);case 86:case"end":return r.stop()}}),r)})))()}}},m=(r(1319),r(55)),component=Object(m.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{staticClass:"mt-1",attrs:{fluid:""}},[e.teaching?r("p",{staticClass:"rightBox"},[r("b-input",{attrs:{size:"sm",placeholder:"SubmitID"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchSubmit(t)}},model:{value:e.submitid,callback:function(t){e.submitid=t},expression:"submitid"}})],1):e._e(),e._v(" "),r("b-modal",{model:{value:e.submitList,callback:function(t){e.submitList=t},expression:"submitList"}},[r("p",{staticClass:"my-3"},[e._v("Which one?")]),e._v(" "),e._l(e.submitList,(function(t,n){return r("p",{key:t.id},[e._v("\n                "+e._s(n+1)+". "+e._s(t.user.name)+" -\n                "+e._s(e.$selectUserLocaleText(t.problem.title))+"\n            ")])}))],2),e._v(" "),r("problem-solver",{attrs:{problem:e.problem,initCode:e.initCode,lang:e.lang,langs:e.langs},on:{submit:e.submit}})],1)}),[],!1,null,"04f519b4",null);t.default=component.exports;installComponents(component,{ProblemSolver:r(865).default})},855:function(e,t,r){"use strict";r(10),r(14),r(22),r(86),r(9),r(856),r(29),r(15);var n=r(228),o=r.n(n),c={pad:function(e){return("0"+e).slice(-2)},mmss:function(e){var t=Math.floor(e/60);return e%=60,"".concat(this.pad(t),":").concat(this.pad(e))},hhmmss:function(e){var t=Math.floor(e/60);e%=60;var r=Math.floor(t/60);return t%=60,"".concat(this.pad(r),":").concat(this.pad(t),":").concat(this.pad(e))},getToday:function(){var e=new Date,dd=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0");return e.getFullYear()+t+dd},getNow:function(){var e=new Date;return""+e.getFullYear()+this.pad(e.getMonth()+1)+this.pad(e.getDate())+this.pad(e.getHours())+this.pad(e.getMinutes())+this.pad(e.getSeconds())},obj2arr:function(e){var t=[],r=Object.keys(e);return r.sort(),r.forEach((function(r){t.push(Object.assign({id:r},e[r]))})),t},arr2obj:function(e){var t={};return e.forEach((function(e){var r=JSON.parse(JSON.stringify(e)),n=e.id;delete r.id,t[n]=r})),t},getOptions:function(e){var t=[];return e.split("#@@#").forEach((function(e){var s=e.split("#@");t.push({text:s[0],value:s[1]})})),t},findIdPos:function(e,t){if(!e)return-1;for(var r=0;r<e.length;r++)if(t==e[r].id)return r;return-1},encode:function(e,t){return new o.a(e).encrypt(t)},decode:function(e,t){return new o.a(e).decrypt(t)}};t.a=c},856:function(e,t,r){"use strict";var n=r(8),o=r(857).start;n({target:"String",proto:!0,forced:r(858)},{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},857:function(e,t,r){var n=r(50),o=r(229),c=r(52),d=Math.ceil,l=function(e){return function(t,r,l){var m,f,h=String(c(t)),x=h.length,v=void 0===l?" ":String(l),S=n(r);return S<=x||""==v?h:(m=S-x,(f=o.call(v,d(m/v.length))).length>m&&(f=f.slice(0,m)),e?h+f:f+h)}};e.exports={start:l(!1),end:l(!0)}},858:function(e,t,r){var n=r(127);e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},866:function(e,t,r){(t=r(56)(!1)).push([e.i,'.vdr{touch-action:none;border:1px dashed #000}.handle,.vdr{position:absolute;box-sizing:border-box}.handle{width:10px;height:10px;background:#eee;border:1px solid #333}.handle-tl{top:-10px;left:-10px;cursor:nw-resize}.handle-tm{top:-10px;left:50%;margin-left:-5px;cursor:n-resize}.handle-tr{top:-10px;right:-10px;cursor:ne-resize}.handle-ml{left:-10px;cursor:w-resize}.handle-ml,.handle-mr{top:50%;margin-top:-5px}.handle-mr{right:-10px;cursor:e-resize}.handle-bl{bottom:-10px;left:-10px;cursor:sw-resize}.handle-bm{bottom:-10px;left:50%;margin-left:-5px;cursor:s-resize}.handle-br{bottom:-10px;right:-10px;cursor:se-resize}@media only screen and (max-width:768px){[class*=handle-]:before{content:"";left:-10px;right:-10px;bottom:-10px;top:-10px;position:absolute}}',""]),e.exports=t},875:function(e,t,r){var content=r(866);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(57).default)("649448c2",content,!0,{sourceMap:!1})}}]);