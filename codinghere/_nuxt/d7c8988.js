(window.webpackJsonp=window.webpackJsonp||[]).push([[72],{1130:function(e,t,r){var content=r(1354);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(57).default)("615ded5c",content,!0,{sourceMap:!1})},1353:function(e,t,r){"use strict";r(1130)},1354:function(e,t,r){(t=r(56)(!1)).push([e.i,".rightBox[data-v-349a3ed3]{position:absolute;right:32px;top:14px;width:120px}.tabs[data-v-349a3ed3]{margin-right:60px}.container-fluid[data-v-349a3ed3]{position:relative;margin:0;padding:0}",""]),e.exports=t},1440:function(e,t,r){"use strict";r.r(t);r(36),r(18),r(58),r(156),r(30),r(27),r(87),r(49);var n=r(7),o=r(855),c=r(864),d=r(26),l={components:{ProblemSolver:c.default},asyncData:function(e){return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.store,n=r.state.params.probSet,t.abrupt("return",{probSet:n});case 3:case"end":return t.stop()}}),t)})))()},data:function(){return{is_teacher:!1,submitid:"",submitList:null,problem:null,baseProblems:{},demo:!1,pgKey:"Coding",lang:"c",langs:"c,cpp,py",initCode:"",lastcode:{},localeText:{Coding_Problem:"問題",Coding_Code:"程式",Coding_Result:"結果",Coding_Reference:"參考"}}},created:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.localeText=e.$updateLocaleText(e.localeText),e.problem=o.a.decode(e.pgKey,e.probSet.problem),e.probSet.initCode&&(e.initCode=e.probSet.initCode.code,e.lang=e.probSet.initCode.lang,e.lastcode={sourceLang:e.lang,sourceCode:e.initCode}),e.probSet.compilers&&e.probSet.compilers.length>0&&(e.langs=e.probSet.compilers.join(","),e.lang=e.probSet.compilers[0]),e.probSet.demo&&(e.demo=!0),"playground"===e.probSet.courseID){t.next=11;break}return r=e.$user("id"),t.next=9,e.$store.dispatch("getCourse",e.probSet.courseID);case 9:(n=t.sent).teachers&&n.teachers.some((function(p){return p.id===r}))&&(e.is_teacher=!0);case 11:case"end":return t.stop()}}),t)})))()},methods:{getBaseProblems:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,c,l,m,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$store.dispatch("getCourse",e);case 2:n=r.sent,o=n.problemSets,r.t0=regeneratorRuntime.keys(o);case 5:if((r.t1=r.t0()).done){r.next=14;break}return c=r.t1.value,r.next=9,d.d.collection("problems").doc(c).get();case 9:for(f in l=r.sent,m=l.data().problems)t.baseProblems[f]=m[f];r.next=5;break;case 14:case"end":return r.stop()}}),r)})))()},setSubmit:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.cid){r.next=3;break}return console.log("Submit has no cid!"),r.abrupt("return");case 3:if(t.baseProblems[e.pid]){r.next=6;break}return r.next=6,t.getBaseProblems(e.cid);case 6:if(t.baseProblems[e.pid]){r.next=9;break}return console.log("Submit pid cannot be found!"),r.abrupt("return");case 9:t.problem=t.baseProblems[e.pid],t.lang=e.lang,t.initCode="",t.$nextTick((function(){t.initCode=e.code})),t.demo=!0;case 14:case"end":return r.stop()}}),r)})))()},searchSubmit:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,c,l,m,f,i,h,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((r=e.submitid.length)<4)){t.next=4;break}return alert("Code should have 4 chars!"),t.abrupt("return");case 4:return n=e.submitid.charCodeAt(r-1),o=e.submitid.substr(0,r-1)+String.fromCharCode(n+1),t.next=8,d.d.collection("submits").where(d.b.firestore.FieldPath.documentId(),">",e.submitid).where(d.b.firestore.FieldPath.documentId(),"<",o).get();case 8:if(!(c=t.sent).empty){t.next=12;break}return alert("No Match Results!"),t.abrupt("return");case 12:if(1!=(l=c.docs).length){t.next=17;break}return m=l[0].data(),e.setSubmit(m),t.abrupt("return");case 17:f=[],i=0;case 19:if(!(i<l.length)){t.next=35;break}if(h=l[i].data(),e.baseProblems[h.pid]){t.next=24;break}return t.next=24,e.getBaseProblems(h.cid);case 24:if(e.baseProblems[h.pid]){t.next=26;break}return t.abrupt("continue",32);case 26:return h.problem=e.baseProblems[h.pid],t.next=29,d.d.collection("users").doc(h.uid).get();case 29:x=t.sent,h.user=x.data(),f.push(h);case 32:i++,t.next=19;break;case 35:e.submitList=f;case 36:case"end":return t.stop()}}),t)})))()},submit:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var c,l,m,f,h,x,v,S,k,w,C,y,T,P,i,O,R;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(c=e.cdata,l=e.result,c.sourceLang!==t.lastcode.sourceLang||c.sourceCode!==t.lastcode.sourceCode){r.next=3;break}return r.abrupt("return");case 3:if(t.lastcode={sourceLang:c.sourceLang,sourceCode:c.sourceCode},m=t.probSet.courseID,f={uid:t.$user("id"),pid:t.problem.id,cid:m,created:o.a.getNow(),lang:c.sourceLang,code:c.sourceCode,status:l.RunStatus,score:l.Score},!t.demo){r.next=8;break}return r.abrupt("return");case 8:return r.next=10,d.d.collection("submits").add(f);case 10:return h=r.sent,f.id=h.id,x=t.$user("id"),r.next=15,d.d.collection("users").doc(x).get();case 15:if(v=r.sent,(S=v.data()).id=x,t.$store.commit("setData",{name:"user",value:S}),k={},t.$user("courses")&&(k=t.$copyObject(t.$user("courses"))),k[m]&&k[m].units||(k[m]={name:t.probSet.courseName,units:{}}),k[m].units[t.probSet.courseUnit]||(k[m].units[t.probSet.courseUnit]={score:0,TS:0,TP:0,probs:{}}),w=k[m].units[t.probSet.courseUnit],(C=w.probs[f.pid])?y=t.$copyObject(C):(y={title:t.problem.title,TS:0,TP:0,score:0,last10:[]},w.probs[f.pid]=y),w.TS+=1,y.TS+=1,T="0/","AC"==f.status&&(w.TP+=1,y.TP+=1,T="1/"),!t.probSet.practice&&f.score>y.score&&(w.score+=f.score-y.score,y.score=f.score),y.last10.splice(0,0,T+f.id),!(y.last10.length>10)){r.next=47;break}if(!(y.last10[10].indexOf("1/")>=0)){r.next=46;break}P=!0,i=0;case 36:if(!(i<10)){r.next=43;break}if(!(y.last10[i].indexOf("1/")>=0)){r.next=40;break}return P=!1,r.abrupt("break",43);case 40:i++,r.next=36;break;case 43:P?y.last10.splice(9,1):y.last10.splice(10,1),r.next=47;break;case 46:y.last10.splice(10,1);case 47:return w.probs[f.pid]=y,r.next=50,d.d.collection("users").doc(t.$user("id")).update({courses:k,updated:o.a.getNow()});case 50:if(t.$store.commit("setObjItem",{obj:"user",name:"courses",value:k}),!t.probSet.practice){r.next=53;break}return r.abrupt("return");case 53:if("playground"===m){r.next=65;break}return O=d.d.collection("courses").doc(m),r.prev=55,r.next=58,d.d.runTransaction(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(r){var n,c,d,l,h,x,u,v,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get(O);case 2:for(n=e.sent,c=n.data(),d=c.units,l={},c.scores&&(l=t.$copyObject(c.scores)),h=[],x=k[m].units,u=0;u<d.length;u++)v=d[u].name,x[v]?h.push(x[v].score):h.push(0);return l[f.uid]=h,S={scores:l,updated:o.a.getNow()},e.next=14,r.update(O,S);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 58:r.next=63;break;case 60:r.prev=60,r.t0=r.catch(55),console.log(r.t0);case 63:return r.next=65,t.$store.dispatch("getCourseT",m);case 65:return R=d.d.collection("problems").doc("STAT"),r.prev=66,r.next=69,d.d.runTransaction(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(r){var n,c,d,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get(R);case 2:return(n=e.sent).exists?(d=n.data()).updated=o.a.getNow():(c={updated:o.a.getNow()},d=c),l=t.problem.id,d[l]||(d[l]={TS:0,TP:0}),d[l].TS+=1,"AC"==f.status&&(d[l].TP+=1),e.next=10,r.set(R,d);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 69:r.next=74;break;case 71:r.prev=71,r.t1=r.catch(66),console.log(r.t1);case 74:case"end":return r.stop()}}),r,null,[[55,60],[66,71]])})))()}}},m=(r(1353),r(55)),component=Object(m.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{staticClass:"mt-1",attrs:{fluid:""}},[e.is_teacher?r("p",{staticClass:"rightBox"},[r("b-input",{attrs:{size:"sm",placeholder:"SubmitID"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchSubmit(t)}},model:{value:e.submitid,callback:function(t){e.submitid=t},expression:"submitid"}})],1):e._e(),e._v(" "),r("b-modal",{model:{value:e.submitList,callback:function(t){e.submitList=t},expression:"submitList"}},[r("p",{staticClass:"my-3"},[e._v("Which one?")]),e._v(" "),e._l(e.submitList,(function(t,n){return r("p",{key:t.id},[r("b-link",{on:{click:function(r){return e.setSubmit(t)}}},[e._v("\n                "+e._s(n+1)+". "+e._s(t.user.name)+" -\n                "+e._s(e.$selectUserLocaleText(t.problem.title))+"\n            ")])],1)}))],2),e._v(" "),r("problem-solver",{attrs:{problem:e.problem,initCode:e.initCode,lang:e.lang,langs:e.langs},on:{submit:e.submit}})],1)}),[],!1,null,"349a3ed3",null);t.default=component.exports;installComponents(component,{ProblemSolver:r(864).default})},855:function(e,t,r){"use strict";r(10),r(14),r(22),r(86),r(9),r(856),r(29),r(15);var n=r(228),o=r.n(n),c={pad:function(e){return("0"+e).slice(-2)},mmss:function(e){var t=Math.floor(e/60);return e%=60,"".concat(this.pad(t),":").concat(this.pad(e))},hhmmss:function(e){var t=Math.floor(e/60);e%=60;var r=Math.floor(t/60);return t%=60,"".concat(this.pad(r),":").concat(this.pad(t),":").concat(this.pad(e))},getToday:function(){var e=new Date,dd=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0");return e.getFullYear()+t+dd},getNow:function(){var e=new Date;return""+e.getFullYear()+this.pad(e.getMonth()+1)+this.pad(e.getDate())+this.pad(e.getHours())+this.pad(e.getMinutes())+this.pad(e.getSeconds())},obj2arr:function(e){var t=[],r=Object.keys(e);return r.sort(),r.forEach((function(r){t.push(Object.assign({id:r},e[r]))})),t},arr2obj:function(e){var t={};return e.forEach((function(e){var r=JSON.parse(JSON.stringify(e)),n=e.id;delete r.id,t[n]=r})),t},getOptions:function(e){var t=[];return e.split("#@@#").forEach((function(e){var s=e.split("#@");t.push({text:s[0],value:s[1]})})),t},findIdPos:function(e,t){if(!e)return-1;for(var r=0;r<e.length;r++)if(t==e[r].id)return r;return-1},encode:function(e,t){return new o.a(e).encrypt(t)},decode:function(e,t){return new o.a(e).decrypt(t)}};t.a=c},856:function(e,t,r){"use strict";var n=r(8),o=r(857).start;n({target:"String",proto:!0,forced:r(858)},{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},857:function(e,t,r){var n=r(50),o=r(229),c=r(52),d=Math.ceil,l=function(e){return function(t,r,l){var m,f,h=String(c(t)),x=h.length,v=void 0===l?" ":String(l),S=n(r);return S<=x||""==v?h:(m=S-x,(f=o.call(v,d(m/v.length))).length>m&&(f=f.slice(0,m)),e?h+f:f+h)}};e.exports={start:l(!1),end:l(!0)}},858:function(e,t,r){var n=r(127);e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},866:function(e,t,r){(t=r(56)(!1)).push([e.i,'.vdr{touch-action:none;border:1px dashed #000}.handle,.vdr{position:absolute;box-sizing:border-box}.handle{width:10px;height:10px;background:#eee;border:1px solid #333}.handle-tl{top:-10px;left:-10px;cursor:nw-resize}.handle-tm{top:-10px;left:50%;margin-left:-5px;cursor:n-resize}.handle-tr{top:-10px;right:-10px;cursor:ne-resize}.handle-ml{left:-10px;cursor:w-resize}.handle-ml,.handle-mr{top:50%;margin-top:-5px}.handle-mr{right:-10px;cursor:e-resize}.handle-bl{bottom:-10px;left:-10px;cursor:sw-resize}.handle-bm{bottom:-10px;left:50%;margin-left:-5px;cursor:s-resize}.handle-br{bottom:-10px;right:-10px;cursor:se-resize}@media only screen and (max-width:768px){[class*=handle-]:before{content:"";left:-10px;right:-10px;bottom:-10px;top:-10px;position:absolute}}',""]),e.exports=t},876:function(e,t,r){var content=r(866);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(57).default)("649448c2",content,!0,{sourceMap:!1})}}]);