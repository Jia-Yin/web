(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1212:function(t,e,n){"use strict";n(938)},1213:function(t,e,n){(e=n(56)(!1)).push([t.i,'[data-v-3fcf4545] h1{color:#00f;font-family:"Arial";font-size:120%;text-decoration:underline;margin:24px 0}[data-v-3fcf4545] h2{color:#ff4500;font-size:100%;margin:16px 0 8px}',""]),t.exports=e},1362:function(t,e,n){"use strict";n.r(e);n(10),n(27),n(79),n(87),n(368),n(49);var r=n(7),o=n(26),c={data:function(){return{infoAlert:!1,info:{title:"",message:""},locales:{zh:"中文"},startDate:"",endDate:"",localeText:{DataMan_Submits:"提交記錄",DataMan_StartDate:"開始日期",DataMan_EndDate:"結束日期",SYS_Export:"匯出",SYS_Download:"下載"}}},methods:{getSubmits:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.d.collection("submits").where("created",">",t.startDate).where("created","<",t.endDate+"240000").get();case 2:if(n=e.sent,r={},!n.empty)for(i=0;i<n.docs.length;i++)r[n.docs[i].id]=n.docs[i].data();return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))()},exportSubmits:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,data,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.startDate&&""!==t.endDate){e.next=2;break}return e.abrupt("return");case 2:return n="submits_".concat(t.startDate,"_").concat(t.endDate,".json"),e.next=5,t.getSubmits();case 5:data=e.sent,r=new Blob([JSON.stringify(data)],{type:"text/plain;charset=utf-8"}),window.navigator.msSaveOrOpenBlob?window.navigator.msSaveBlob(r,n):((o=window.document.createElement("a")).href=window.URL.createObjectURL(r),o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o));case 8:case"end":return e.stop()}}),e)})))()}}},l=(n(1212),n(55)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",{attrs:{fluid:""}},[n("b-modal",{attrs:{title:t.info.title},model:{value:t.infoAlert,callback:function(e){t.infoAlert=e},expression:"infoAlert"}},[t._v(t._s(t.info.message)+"\n    ")]),t._v(" "),n("div",[n("h1",[t._v(t._s(t.localeText.DataMan_Submits))]),t._v(" "),n("div",{staticClass:"d-flex justify-content-start"},[n("span",{staticClass:"mt-2"},[t._v(t._s(t.localeText.SYS_Download))]),t._v(" "),n("b-input",{staticClass:"w-25 ml-3",attrs:{placeholder:t.localeText.DataMan_StartDate},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),n("b-input",{staticClass:"w-25 ml-3",attrs:{placeholder:t.localeText.DataMan_EndDate},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}),t._v(" "),n("b-button",{staticClass:"ml-3",attrs:{size:"sm",variant:"success"},on:{click:t.exportSubmits}},[t._v(t._s(t.localeText.SYS_Export))])],1)])],1)}),[],!1,null,"3fcf4545",null);e.default=component.exports},938:function(t,e,n){var content=n(1213);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(57).default)("3359d6e2",content,!0,{sourceMap:!1})}}]);