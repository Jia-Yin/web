(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{751:function(t,e,n){var content=n(795);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(40).default)("1c97f69d",content,!0,{sourceMap:!1})},752:function(t,e,n){var content=n(797);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(40).default)("d19f2e52",content,!0,{sourceMap:!1})},794:function(t,e,n){"use strict";var o=n(751);n.n(o).a},795:function(t,e,n){(e=n(39)(!1)).push([t.i,".qpanel[data-v-c542fb2c]{background:#eee;padding:24px}.question[data-v-c542fb2c]{color:#00f;font-size:120%}.progress[data-v-c542fb2c] .progress-bar{transition:width 1s linear}",""]),t.exports=e},796:function(t,e,n){"use strict";var o=n(752);n.n(o).a},797:function(t,e,n){(e=n(39)(!1)).push([t.i,".qpanel[data-v-27f31930]{background:#eee;padding:24px}.question[data-v-27f31930]{color:#00f}.progress[data-v-27f31930] .progress-bar{transition:width 1s linear}",""]),t.exports=e},800:function(t,e,n){"use strict";n.r(e);n(11);var o=n(757),r=n.n(o),l={props:{quiz:Object,shuffle:Boolean,submit:Function,times:Number,skip:Boolean},data:function(){return{shuffledIndex:null,options:null,answered:!1,time:0,ptime:0,timer:null}},watch:{skip:function(t){console.log("RT skip Changed!"),t&&(this.timer&&(console.log("Clear Timer"),clearInterval(this.timer)),console.log("SKIP"),this.choose(-1))},quiz:{immediate:!0,handler:function(t){console.log("Quiz",t),this.timer&&clearInterval(this.timer),this.answered=!1,this.shuffledIndex=r.a.range(t.options.length),this.shuffle&&(this.shuffledIndex=r.a.shuffle(this.shuffledIndex)),this.options=r.a.map(this.shuffledIndex,(function(e){return t.options[e]})),this.time=this.times,this.ptime=this.times,this.startTimer()}}},methods:{choose:function(t){(this.skip||!this.answered&&this.times-this.time>0)&&(console.log("RT choose Called!"),this.answered=!0,clearInterval(this.timer),this.submit(t))},startTimer:function(){var t=this;setTimeout((function(){t.ptime--}),10),console.log("Start RT timer"),this.timer=setInterval((function(){t.time--,t.ptime--,0===t.time&&(console.log("RT Timeout"),t.choose(-1))}),1e3)}}},c=(n(794),n(33)),h=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"qpanel"},[n("b-progress",{attrs:{variant:"warning",value:t.ptime,max:t.times}}),t._v(" "),n("div",{staticClass:"my-3 question",domProps:{innerHTML:t._s(t.$md.render(t.quiz.question))}}),t._v(" "),n("hr"),t._v(" "),n("b-list-group",{staticClass:"mb-1"},t._l(t.options,(function(option,e){return n("b-list-group-item",{key:e,staticClass:"mb-2",attrs:{button:""},on:{click:function(n){return t.choose(t.shuffledIndex[e])}}},[t._v(t._s(option))])})),1)],1)}),[],!1,null,"c542fb2c",null).exports,m=(n(18),n(58),n(16)),d=n(0),f={props:{quiz:Object,shuffle:Boolean,submit:Function,times:Number,skip:Boolean},data:function(){var t;return t={shuffledIndex:null,options:null,answered:!1,time:0,ptime:0,timer:null,servers:null,protocol:""},Object(d.a)(t,"servers",null),Object(d.a)(t,"maxavail",0),Object(d.a)(t,"results",null),Object(d.a)(t,"cmOption",{tabSize:3,indentUnit:3,styleActiveLine:!0,lineNumbers:!0,readOnly:!1,matchTags:!0,matchBrackets:!0,autoCloseBrackets:!0,indentWithTabs:!0,mode:"text/x-c++src",theme:"mdn-like",problemid:null,problem:{name:"載入中..."},tabidx:0,language:"c",code:"",cmstyle:{"font-size":"100%"},cmfontsize:100,info:{RunStatus:"Not Available",StyleCheck:"N/A",ErrorCase:null}}),t},mounted:function(){this.checkServer()},watch:{skip:function(t){console.log("RT skip Changed!"),t&&(this.timer&&(console.log("Clear Timer"),clearInterval(this.timer)),console.log("SKIP"),this.choose(-1))},quiz:{immediate:!0,handler:function(t){console.log("Quiz",t),this.timer&&clearInterval(this.timer),this.answered=!1,this.time=this.times,this.ptime=this.times,this.startTimer()}}},methods:{checkServer:function(){var t=this;return Object(m.a)(regeneratorRuntime.mark((function e(){var n,o,i,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t,t.$store.state.servers){e.next=4;break}return e.next=4,t.$store.dispatch("getServers").then((function(t){console.log("Get SERVER RESULT:",t)})).catch((function(t){console.log("Get SERVER ERROR:",t)}));case 4:for(n="ws://","https:"==document.location.protocol?(t.servers=t.$store.state.servers.https,n="wss://"):t.servers=t.$store.state.servers.http,o=t.servers.length,i=0;i<o;i++)r=n+t.servers[i],t.sendMessage(r,"HELLO"+i);case 8:case"end":return e.stop()}}),e)})))()},send:function(){console.log("SEND CALLED"),this.check(),console.log("Submit Code:",this.cmOption.code),console.log("RESULTS",this.results),clearInterval(this.timer),"PASS"===this.results?this.submit(0):this.submit(-1)},check:function(){var code=this.cmOption.code,t=this.quiz.testcode.replace("CODEHERE",code),content=(t.replace(/\"/g,'\\"'),'CODE:{"sourcecode":'+JSON.stringify(t));content+=',"testdata":{"style":"RUN","testsets":[{"testcases":[{"input":""}]}]}}',this.sendMessage(this.protocol,content)},parseMessage:function(t){var data=JSON.parse(t.data);if("string"==typeof data&&"HELLO:"===data.substr(0,6)){var e=data.substr(6),n=e.indexOf(":");console.log("SERVER NO = ",e.substr(0,n)),console.log("NUMSTR = ",e.substr(n+1));var o=parseInt(e.substr(n+1),10);console.log("NUM = ",o),o>this.maxavail&&(this.maxavail=o,this.protocol=t.origin,this.status="SRV-"+e.substr(0,n),console.log("Choose Server:",this.protocol))}else try{this.cmOption.info=JSON.parse(t.data);var r=this.cmOption.info.RunStatus;if(console.log("STATUS",r),r.indexOf('["AC"]')>=0)alert("PASS"),this.results="PASS";else if(r.indexOf("Wrong")>=0){var l=r.replace(/\\n/g,"\n");l=(l=l.replace('["',"")).replace('"]',""),alert(l),this.results=l}else alert(r),this.results=r;r.indexOf("error")>=0?r="CE":"AC"!=r&&(r="WA",console.log("ERRORCASE",this.cmOption.info.ErrorCase))}catch(t){alert(t)}this.trial=!1},sendMessage:function(t,content){var e=this,n=t+"/submit",o=null;try{o=new WebSocket(n)}catch(t){console.log("Error",t)}o.onopen=function(t){o.send(content)},o.onmessage=function(t){console.log("Receive:",t.data),e.parseMessage(t),e.disabled=!1,o.close()},o.onclose=function(t){console.log("WS closed:",t)},o.onerror=function(t){console.log("Socket ERR:",t),o.close()}},onCmReady:function(t){t.setSize(null,500)},choose:function(t){(this.skip||!this.answered&&this.times-this.time>0)&&(console.log("RT choose Called!"),this.answered=!0,clearInterval(this.timer),this.submit(t))},startTimer:function(){var t=this;setTimeout((function(){t.ptime--}),10),console.log("Start RT timer"),this.timer=setInterval((function(){t.time--,t.ptime--,0===t.time&&(console.log("RT Timeout"),t.choose(-1))}),1e3)}}},v=(n(796),{middleware:["authenticated"],layout:"answer",components:{RTSingle:h,FuncTest:Object(c.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"qpanel"},[n("b-progress",{attrs:{variant:"warning",value:t.ptime,max:t.times}}),t._v(" "),n("div",{staticClass:"my-3 question",domProps:{innerHTML:t._s(t.$md.render(t.quiz.question))}}),t._v(" "),n("hr"),t._v(" "),n("b-button",{on:{click:function(e){return t.check()}}},[t._v("測試")]),t._v(" "),n("b-button",{on:{click:function(e){return t.send()}}},[t._v("提交")]),t._v(" "),n("codemirror",{style:t.cmOption.cmstyle,attrs:{options:t.cmOption},on:{ready:t.onCmReady},model:{value:t.cmOption.code,callback:function(e){t.$set(t.cmOption,"code",e)},expression:"cmOption.code"}}),t._v(" "),n("div",[t._v(t._s(t.results))])],1)}),[],!1,null,"27f31930",null).exports},data:function(){return{time:1e3,timer:null,index:0,numCorrect:0,numTotal:0,lastskip:1e6,skip:!1,finished:!1}},mounted:function(){var t=this;console.log("Start timer"),this.timer=setInterval((function(){t.time--,t.time}),1e3)},computed:{quizzes:function(){if(console.log("QUIZZES",this.$store.state.quizzes),this.$store.state.quizzes&&this.$store.state.quizzes.length>=5){var t=JSON.parse(JSON.stringify(this.$store.state.quizzes)),e=JSON.parse(JSON.stringify(t[0])),n=JSON.parse(JSON.stringify(t[4]));return t[0]=n,t[4]=e,t}return this.$store.state.quizzes},user:function(){return this.$store.state.user},ready:function(){return this.quizzes&&this.quizzes.length>0}},created:function(){var t=this;console.log("Quizzes",this.quizzes),void 0!==this.$store.state.params.quizzes&&0!==this.$store.state.params.quizzes.length||this.$store.dispatch("getCollection","quizzes").then((function(){console.log("Get Quizzes",t.quizzes)}))},methods:{skipquiz:function(){this.lastskip>this.time+1&&(this.lastskip=this.time,this.skip=!0)},submit:function(t){console.log("Answer = ",t),this.numTotal++,!this.finished&&this.index<this.quizzes.length-1?(this.skip=!1,this.index++):(console.log("Finished, Leave Out!"),this.leave())},leave:function(){var t=this;clearInterval(this.timer),this.skip=!0,this.finished=!0,setTimeout((function(){t.$router.push("/user")}),100)},pad:function(t){return("0"+t).slice(-2)},hhmmss:function(t){var e=Math.floor(t/60);t%=60;var n=Math.floor(e/60);return e%=60,"".concat(this.pad(n),":").concat(this.pad(e),":").concat(this.pad(t))}}}),z=Object(c.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",[n("b-navbar",{attrs:{variant:"light"}},[n("b-navbar-nav",{staticClass:"mr-auto"},[n("b-nav-text",{staticClass:"text-dark"},[t._v(t._s(t.user&&t.user.name))])],1),t._v(" "),n("b-navbar-nav",{staticClass:"mr-auto"},[n("b-nav-text",{staticClass:"text-primary"},[t._v("總共剩餘時間 "+t._s(t.hhmmss(t.time)))])],1),t._v(" "),n("b-navbar-nav",{staticClass:"mr-auto"},[n("b-button",{staticClass:"ml-3 btn-sm btn-outline-success",attrs:{variant:"outline-success"},on:{click:function(e){return t.skipquiz()}}},[t._v("跳過本題")]),t._v(" "),n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-leave",modifiers:{"modal-leave":!0}}],staticClass:"ml-3 btn btn-sm btn-outline-danger",attrs:{variant:"outline-danger"}},[t._v("離開考場")]),t._v(" "),n("b-modal",{attrs:{id:"modal-leave",title:"溫馨提醒","ok-title":"確定","cancel-title":"取消","no-close-on-esc":!0,"no-close-on-backdrop":!0},on:{ok:function(e){return t.leave()}}},[n("p",{staticClass:"mt-4 text-danger"},[t._v("此視窗顯示時，計時不會暫停。")]),t._v(" "),n("p",{staticClass:"my-4 text-danger"},[t._v("\n          離開考場等於交卷，不得再次進入！\n          "),n("br"),t._v("確定要離開嗎？\n        ")])])],1),t._v(" "),n("b-navbar-nav",[n("b-nav-text",{staticClass:"text-dark"},[t._v(t._s(t.index+1)+" / "+t._s(t.quizzes&&t.quizzes.length))])],1)],1),t._v(" "),t.ready&&"singlechoice"==t.quizzes[t.index].type?n("RTSingle",{key:t.index,attrs:{shuffle:!0,times:20,quiz:t.quizzes[t.index],submit:t.submit,skip:t.skip}}):t._e(),t._v(" "),t.ready&&"functest"==t.quizzes[t.index].type?n("FuncTest",{key:t.index,attrs:{times:6e3,quiz:t.quizzes[t.index],submit:t.submit,skip:t.skip}}):t._e()],1)}),[],!1,null,null,null);e.default=z.exports}}]);