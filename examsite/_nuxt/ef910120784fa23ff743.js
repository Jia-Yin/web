(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{749:function(t,e,n){var content=n(779);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(40).default)("2d9855ae",content,!0,{sourceMap:!1})},750:function(t,e,n){"use strict";n(18),n(1);var c=n(786),o=n.n(c),r={checkServer:function(t){return new Promise((function(e,n){var c="ws://",r=t.http;"https:"==document.location.protocol&&(r=t.https,c="wss://");for(var l=r.length,d=0,f=null,h=0,m=[],v=function(i){var t=c+r[i],v=t+"/submit",y=new o.a(v,{packMessage:function(data){return data.content},unpackMessage:function(data){return data},attachRequestId:function(data,t){return Object.assign({id:t},data)},extractRequestId:function(data){return i}});y.open().then((function(){return y.sendRequest({content:"HELLO"+i},{requestId:i})})).then((function(c){var o=c.substr(7),v=o.indexOf(":"),y=parseInt(o.substr(v+1),10);m.push({server:r[i],capacity:y}),y>d&&(d=y,f=t),++h===l&&(d>0?e({best:{channel:f+"/submit",capacity:d},available:m}):n("Judger not available!"))})).catch((function(t){++h===l&&(d>0?e({best:{channel:f+"/submit",capacity:d},available:m}):n("Judger not available!"))}))},i=0;i<l;i++)v(i)}))},judgeFunctest:function(t,code){var content={sourcecode:code,sourcelang:"cpp",testdata:{style:"RUN",testsets:[{testcases:[{input:""}]}]}};return new Promise((function(e,n){var c=new o.a(t,{packMessage:function(data){return"CODE:"+JSON.stringify(data.content)},unpackMessage:function(data){return data},attachRequestId:function(data,t){return Object.assign({id:t},data)},extractRequestId:function(data){return 13789}});c.open().then((function(){return c.sendRequest({content:content},{requestId:13789})})).then((function(t){try{var c=JSON.parse(t).RunStatus;if(c.indexOf('["AC"]')>=0)e("AC");else if(c.indexOf("Wrong")>=0){var o=c.replace(/\\n/g,"\n");o=(o=o.replace('["',"")).replace('"]',""),e(o)}else e(c)}catch(t){console.log("Error:",t),n(t)}})).catch((function(t){console.log("Error:",t),n(t)}))}))},judgeProgtest:function(t,e){var n=this;return console.log("Codedata",e),new Promise((function(c,r){var l=new o.a(t,{packMessage:function(data){return"CODE:"+JSON.stringify(data.content)},unpackMessage:function(data){return data},attachRequestId:function(data,t){return Object.assign({id:t},data)},extractRequestId:function(data){return 25789}});l.open().then((function(){return l.sendRequest({content:e},{requestId:25789})})).then((function(t){try{var e=JSON.parse(t),o=e.RunStatus;if("AC"===o)c("AC");else if("WA"===o||"PE"===o){var l=e.ErrorCase;n.result=o+"\n\nWrong Case:\n",n.result+="Input:\n"+l.input.replace(/\n/g,"\\n\n")+"\n",n.result+="Right:\n"+l.right.replace(/\n/g,"\\n\n")+"\n",n.result+="Wrong:\n"+l.wrong.replace(/\n/g,"\\n\n"),c(n.result)}else c(o)}catch(t){console.log("Error:",t),r(t)}})).catch((function(t){console.log("Error:",t),r(t)}))}))}};e.a=r},758:function(t,e,n){"use strict";n(5),n(2),n(3),n(1),n(4),n(58);var c=n(14),o=n(0),r=(n(11),n(100)),l=n(750);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var f={props:{value:String,height:Number,ready:Function,check:Function,submit:Function},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(r.b)({sendRemind:function(t){return t.params.sendRemind}})),data:function(){return{defaultchannel:"C",connstatus:"success",cmstyle:{"font-size":"100%"},cmfontsize:100,cm:null,cmcode:null,cmOption:{tabSize:3,indentUnit:3,styleActiveLine:!0,lineNumbers:!1,readOnly:!1,matchTags:!0,matchBrackets:!0,autoCloseBrackets:!0,indentWithTabs:!0,mode:"text/x-c++src",theme:"mdn-like"}}},mounted:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.cmcode=t.value,t.$store.state.servers){e.next=4;break}return e.next=4,t.$store.dispatch("getServers");case 4:l.a.checkServer(t.$store.state.servers).then((function(e){t.connstatus="success";var n=e.best.channel.toUpperCase();console.log("CHN",n),"WSS"===n.substr(0,3)?t.defaultchannel=n.substr(6,1):t.defaultchannel=n.substr(5,1),t.$emit("servers",e)})).catch((function(e){t.connstatus="danger",console.log("CP Error",e)}));case 5:case"end":return e.stop()}}),e)})))()},methods:{send:function(){void 0===this.sendRemind||this.sendRemind?this.$bvModal.show("modal-send"):this.submit()},toggleRemind:function(t){this.$store.commit("setObject",{key:"sendRemind",value:!t})},cinput:function(t){this.$emit("input",t)},incfont:function(){this.cmfontsize+=10,this.cmstyle={"font-size":"".concat(this.cmfontsize,"%")}},decfont:function(){this.cmfontsize-=10,this.cmstyle={"font-size":"".concat(this.cmfontsize,"%")}},resetfont:function(){this.cmfontsize=100,this.cmstyle={"font-size":"".concat(this.cmfontsize,"%")}},onCmReady:function(t){this.cm=t,t.setSize(null,this.height)}},watch:{height:function(t){this.cm.setSize(null,t)}}},h=(n(778),n(33)),component=Object(h.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"col-container"},[n("div",{staticClass:"toolbar"},[n("div",{staticClass:"bgroup"},[n("b-button",{attrs:{size:"sm",variant:"outline-primary"},on:{click:t.check}},[t._v("測")]),t._v(" "),n("b-button",{staticClass:"my-2",attrs:{size:"sm",variant:"outline-primary"},on:{click:t.incfont}},[n("fa",{attrs:{icon:"plus"}})],1),t._v(" "),n("b-button",{attrs:{size:"sm",variant:"outline-primary"},on:{click:t.resetfont}},[n("fa",{attrs:{icon:["far","circle"]}})],1),t._v(" "),n("b-button",{staticClass:"my-2",attrs:{size:"sm",variant:"outline-primary"},on:{click:t.decfont}},[n("fa",{attrs:{icon:"minus"}})],1),t._v(" "),n("b-button",{attrs:{size:"sm",variant:"outline-primary"},on:{click:function(e){return t.send()}}},[t._v("交")])],1),t._v(" "),n("b-button",{staticClass:"connstatus",attrs:{disabled:!0,size:"sm",variant:t.connstatus}},["danger"!=t.connstatus?n("span",[t._v(t._s(t.defaultchannel))]):n("span",[n("fa",{attrs:{icon:["far","times-circle"]}})],1)])],1),t._v(" "),n("codemirror",{staticClass:"coder",style:t.cmstyle,attrs:{options:t.cmOption},on:{ready:t.onCmReady,input:t.cinput},model:{value:t.cmcode,callback:function(e){t.cmcode=e},expression:"cmcode"}})],1),t._v(" "),n("b-modal",{attrs:{centered:!0,id:"modal-send",title:"程式提交","ok-title":"確定","cancel-title":"取消","no-close-on-esc":!0,"no-close-on-backdrop":!0},on:{ok:t.submit}},[n("p",{staticClass:"mt-4 text-danger"},[t._v("提交之後，即進到下一題，無法再回頭修改，確定要提交嗎？")]),t._v(" "),n("b-form-checkbox",{attrs:{id:"checkbox-1",name:"checkbox-1"},on:{change:t.toggleRemind}},[t._v("以後不再提醒")])],1)],1)}),[],!1,null,"a22032ac",null);e.a=component.exports},778:function(t,e,n){"use strict";var c=n(749);n.n(c).a},779:function(t,e,n){(e=n(39)(!1)).push([t.i,".col-container[data-v-a22032ac]{display:flex;width:100%}.toolbar[data-v-a22032ac]{display:flex;flex-direction:column;justify-content:space-between;background:#fafad2;padding:12px;border:1px solid #00f;border-right:none}.coder[data-v-a22032ac]{flex:1 1 0;padding:12px;border:1px solid #00f}.btn[data-v-a22032ac]{display:block;width:40px}",""]),t.exports=e},912:function(t,e,n){"use strict";n.r(e);n(18),n(58);var c=n(14),o=n(758),r=n(750),l={components:{CodePanel:o.a},data:function(){return{mycode:"#include <stdio.h>\n\nint main()\n{\n  int x, y;\n  int z;\n}\n\n ",channel:null,qid:"EQJVelAp24dXvR7GBzFr",quiz:null}},created:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.$store.dispatch("getCollectionItem",{collection:"quizzes",id:t.qid}).then((function(e){t.quiz=e}));case 1:case"end":return e.stop()}}),e)})))()},methods:{servers:function(t){console.log("Available",t.available),this.channel=t.best.channel,console.log("Channel",this.channel)},ready:function(){},check:function(){console.log("Check Called!");var code=this.mycode,t=this.quiz.testcode.replace("CODEHERE",code);r.a.judgeFunctest(this.channel,t).then((function(t){console.log("CM Result:",t)}))},send:function(){console.log("SEND CALLED"),this.check(),console.log("Submit Code:",this.mycode),console.log("RESULT",this.result),"通過"===this.result?this.choose({correct:!0,uans:this.mycode}):this.choose({correct:!1,uans:this.mycode})},show:function(){console.log("mycode======",this.mycode)}}},d=n(33),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("CodePanel",{attrs:{check:t.check,submit:t.send,height:500},on:{servers:t.servers},model:{value:t.mycode,callback:function(e){t.mycode=e},expression:"mycode"}}),t._v(" "),n("b-button",{attrs:{to:"/admin/quizlist"}},[t._v("QuizList")])],1)}),[],!1,null,null,null);e.default=component.exports}}]);