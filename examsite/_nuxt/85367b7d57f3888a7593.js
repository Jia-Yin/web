(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{744:function(t,e,n){"use strict";n(745);var r={pad:function(t){return("0"+t).slice(-2)},mmss:function(t){var e=Math.floor(t/60);return t%=60,"".concat(this.pad(e),":").concat(this.pad(t))},hhmmss:function(t){var e=Math.floor(t/60);t%=60;var n=Math.floor(e/60);return e%=60,"".concat(this.pad(n),":").concat(this.pad(e),":").concat(this.pad(t))},getToday:function(){var t=new Date,dd=String(t.getDate()).padStart(2,"0"),e=String(t.getMonth()+1).padStart(2,"0");return t.getFullYear()+e+dd}};e.a=r},745:function(t,e,n){"use strict";var r=n(23),o=n(746),c=n(285),l=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(c);r(r.P+r.F*l,"String",{padStart:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},746:function(t,e,n){var r=n(50),o=n(286),c=n(52);t.exports=function(t,e,n,l){var m=String(c(t)),f=m.length,d=void 0===n?" ":String(n),h=r(e);if(h<=f||""==d)return m;var v=h-f,x=o.call(d,Math.ceil(v/d.length));return x.length>v&&(x=x.slice(0,v)),l?x+m:m+x}},762:function(t,e,n){var content=n(801);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(40).default)("7d105694",content,!0,{sourceMap:!1})},800:function(t,e,n){"use strict";var r=n(762);n.n(r).a},801:function(t,e,n){(e=n(39)(!1)).push([t.i,".modal-content[data-v-93b0d260]{position:fixed;left:365px;top:365px;width:50%;height:50%;background:#e0ffff}",""]),t.exports=e},895:function(t,e,n){"use strict";n.r(e);n(5),n(2),n(3),n(1),n(4),n(58);var r=n(14),o=n(0),c=n(100),l=n(744);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var f={data:function(){return{short:!0,fields:[{key:"title",label:"Title",sortable:!0,sortDirection:"desc"},{key:"totalscore",label:"Score",sortable:!1},{key:"timelimit",label:"Time",sortable:!1},{key:"probs",label:"Detail",sortable:!1},{key:"actions",label:"Action",class:"text-center"}],totalRows:1,currentPage:1,perPage:5,pageOptions:[5,10,15],sortBy:"",sortDesc:!1,sortDirection:"asc",filter:null,filterOn:[],todel:null,selected:[],cachequiz:{},tmap:{singlechoice:0,fillin:1,functest:2,progtest:3}}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(c.b)({user:function(t){return t.user},quizzes:function(t){return t.quizzes},exams:function(t){return t.exams}})),mounted:function(){this.totalRows=this.exams.length},created:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.quizzes||0!==t.quizzes.length){e.next=3;break}return e.next=3,t.$store.dispatch("getCollection","quizzes").then((function(){}));case 3:if(!t.exams||0!==t.exams.length){e.next=6;break}return e.next=6,t.$store.dispatch("getCollection","exams").then((function(){t.totalRows=t.exams.length}));case 6:case"end":return e.stop()}}),e)})))()},methods:{onRowSelected:function(t){this.selected=t,this.$emit("rowSelected",t)},onFiltered:function(t){this.totalRows=t.length,this.currentPage=1},editexam:function(t){this.$store.commit("setObject",{key:"exam",value:t}),this.$router.push("/admin/examedit")},copyexam:function(t){var e=this,n=JSON.parse(JSON.stringify(t));delete n.id,n.title+="(COPY)",this.$store.dispatch("addCollectionItem",{collection:"exams",item:n}).then((function(){e.$router.push("/admin/examlist")}))},testexam:function(t){this.$store.commit("setObject",{key:"exam",value:t}),this.$router.push("/admin/testexam")},deleteexam:function(){var t=this;this.$store.dispatch("deleteDoc",{collection:"exams",id:this.todel.id}).then((function(){t.$router.push("/admin/examlist")}))},deleteconfirm:function(t){this.todel=t,this.$bvModal.show("modal-delete")},typcmp:function(t,e){return this.tmap[t.type]-this.tmap[e.type]},listprobshort:function(t){var e=this,n=0,r=[0,0,0,0];return t.forEach((function(t){n+=t.timelimit;var o=e.quizbyid(t.id),c=e.tmap[o.type];r[c]++})),"單選".concat(r[0],"，填空").concat(r[1],"，函式").concat(r[2],"，程式").concat(r[3])+"；共".concat(this.mmss(n))},listprob:function(t){var e=this,n=0,r=t.map((function(p){var t={id:p.id};return t.title=p.title,t.question=p.question,t.timelimit=p.timelimit,n+=p.timelimit,t.score=p.score,t}));return r.sort(this.typcmp),"Total Time = "+this.hhmmss(n)+"<br>"+r.map((function(t){return e.typename(e.quizbyid(t.id).type)+"--"+e.quizbyid(t.id).title+"--"+t.score+"--"+e.mmss(t.timelimit)})).join("<br>")},typename:function(t){return"singlechoice"===t?"單選":"fillin"===t?"填充":"functest"===t?"函式":"progtest"===t?"程式":"？？"},quizbyid:function(t){if(this.cachequiz[t])return this.cachequiz[t];for(var i=0;i<this.quizzes.length;i++)if(this.quizzes[i].id===t)return this.cachequiz[t]=this.quizzes[i],this.quizzes[i];return null},quiztitle:function(t){if(this.cachequiztitle[t])return this.cachequiztitle[t];for(var i=0;i<this.quizzes.length;i++)if(this.quizzes[i].id===t)return this.cachequiztitle[t]=this.quizzes[i].title,this.quizzes[i].title;return"Unknown"},mmss:function(t){return l.a.mmss(t)},hhmmss:function(t){return l.a.hhmmss(t)}},watch:{exams:function(t){this.totalRows=this.exams.length}}},d=(n(800),n(33));function h(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var v={components:{ExamMan:Object(d.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"qpanel"},[n("b-row",[n("b-col",{staticClass:"my-1",attrs:{md:"4"}},[n("b-form-group",{staticClass:"mb-0",attrs:{label:"Filter","label-cols-sm":"3","label-align-sm":"right","label-size":"sm","label-for":"filterInput"}},[n("b-input-group",{attrs:{size:"sm"}},[n("b-form-input",{attrs:{type:"search",id:"filterInput",placeholder:"Type to Search"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t._v(" "),n("b-input-group-append",[n("b-button",{attrs:{disabled:!t.filter},on:{click:function(e){t.filter=""}}},[t._v("Clear")])],1)],1)],1)],1),t._v(" "),n("b-col",{staticClass:"my-1",attrs:{md:"2"}},[n("b-form-group",{staticClass:"mb-0",attrs:{label:"N","label-cols-sm":"6","label-cols-md":"4","label-cols-lg":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[n("b-form-select",{attrs:{id:"perPageSelect",size:"sm",options:t.pageOptions},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),n("b-col",{staticClass:"my-1",attrs:{md:"2"}},[n("b-button",{attrs:{size:"sm",variant:"outline-success",to:"/admin/examadd"}},[t._v("New")]),t._v(" "),n("b-button",{attrs:{size:"sm",variant:"outline-success"},on:{click:function(e){t.short=!t.short}}},[t._v("S")])],1),t._v(" "),n("b-col",{staticClass:"my-1",attrs:{md:"4"}},[n("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),n("b-modal",{attrs:{id:"modal-delete",title:"確認刪除"},on:{ok:function(e){return t.deleteexam()}}},[n("p",{staticClass:"my-4"},[t._v(t._s(t.todel&&t.todel.title))])]),t._v(" "),n("b-table",{staticClass:"mt-3",attrs:{"show-empty":"",small:"",stacked:"md",selectable:!0,"select-mode":"range",items:t.exams,fields:t.fields,"current-page":t.currentPage,"per-page":t.perPage,filter:t.filter,filterIncludedFields:t.filterOn,"sort-by":t.sortBy,"sort-desc":t.sortDesc,"sort-direction":t.sortDirection},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e},filtered:t.onFiltered,"row-selected":t.onRowSelected},scopedSlots:t._u([{key:"cell(probs)",fn:function(data){return[t.short?n("span",{domProps:{innerHTML:t._s(t.listprobshort(data.value))}}):n("span",{domProps:{innerHTML:t._s(t.listprob(data.value))}})]}},{key:"cell(actions)",fn:function(e){return[n("b-button-group",[n("b-button",{attrs:{size:"sm",variant:"outline-primary"},on:{click:function(n){return t.testexam(e.item)}}},[n("fa",{attrs:{icon:"check"}})],1),t._v(" "),n("b-button",{attrs:{size:"sm",variant:"outline-primary"},on:{click:function(n){return t.editexam(e.item)}}},[n("fa",{attrs:{icon:"edit"}})],1),t._v(" "),n("b-button",{attrs:{size:"sm",variant:"outline-primary"},on:{click:function(n){return t.copyexam(e.item)}}},[n("fa",{attrs:{icon:"copy"}})],1),t._v(" "),n("b-button",{attrs:{size:"sm",variant:"outline-primary"},on:{click:function(n){return t.deleteconfirm(e.item)}}},[n("fa",{attrs:{icon:"trash-alt"}})],1)],1)]}}])})],1)}),[],!1,null,"93b0d260",null).exports},data:function(){return{runningexam:null,examselected:[]}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(c.b)({user:function(t){return t.user}})),created:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!1,r=null,e.next=4,t.$store.dispatch("getCollectionItem",{collection:"comms",id:"exam"}).then((function(t){r=t,n=t.start}));case 4:if(!n){e.next=9;break}return e.next=7,t.$store.dispatch("getCollectionItem",{collection:"exams",id:r.examid}).then((function(e){t.runningexam=e}));case 7:e.next=10;break;case 9:t.runningexam=null;case 10:case"end":return e.stop()}}),e)})))()},methods:{startexam:function(t){var e=this,n={collection:"comms",id:"exam",examid:t,start:!0};this.$store.dispatch("updateCollectionItem",n).then((function(t){e.status="Exam Running...",e.runningexam=n}))},examRowSelected:function(t){this.examselected=t},stopexam:function(){var t=this;this.$store.dispatch("updateCollectionItem",{collection:"comms",id:"exam",start:!1,examid:null}).then((function(e){t.runningexam=null}))}}},x=Object(d.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",{attrs:{fluid:""}},[n("h2",{staticClass:"my-4"},[t._v("Exam List")]),t._v(" "),t.runningexam?n("div",[t._v("\n    "+t._s(t.runningexam.title)+" is running    \n    "),n("b-button",{attrs:{size:"sm",variant:"outline-success"},on:{click:t.stopexam}},[t._v("Stop")])],1):n("div",[t._v("\n    No running exam.\n  ")]),t._v(" "),n("ExamMan",{staticClass:"mt-4",on:{rowSelected:t.examRowSelected}})],1)}),[],!1,null,null,null);e.default=x.exports}}]);