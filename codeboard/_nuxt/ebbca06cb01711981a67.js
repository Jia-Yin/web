(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{324:function(t,e,n){var content=n(374);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(28).default)("545aae07",content,!0,{sourceMap:!1})},373:function(t,e,n){"use strict";var r=n(324);n.n(r).a},374:function(t,e,n){(t.exports=n(27)(!1)).push([t.i,"h4[data-v-40252806]{color:#00f;font-size:100%;text-decoration:underline}form[data-v-40252806]{margin-top:30px;width:90%}.mark-area[data-v-40252806]{width:100%;position:fixed;bottom:0;height:33%;overflow:auto}.users[data-v-40252806]{background:#e0ffff}.courses[data-v-40252806]{background:#ffffe0}.groups[data-v-40252806]{background:#e0ffff}.problems[data-v-40252806]{background:#ffffe0}.link[data-v-40252806]{background:#ffb6c1;min-height:280px}",""])},415:function(t,e,n){"use strict";n.r(e);var r=n(322),o=n(321).helpers.regex("fullTime",/^\d\d\d\d-\d\d-\d\d\s\d\d:\d\d:\d\d\s*$/),l={middleware:["authadmin"],layout:"adminLayout",mixins:[r.validationMixin],data:function(){return{linkcount:0,linkok:0,linkForm:{start:null,end:null,status:!0},statuses:[{text:"開放狀態",value:null},{text:"開放",value:!0},{text:"不開放",value:!1}]}},validations:{linkForm:{start:{fullTime:o},end:{fullTime:o},status:{}}},methods:{markedList:function(t){var e=[];if(t)for(var i=0;i<t.length;i++)t[i].mark&&e.push(t[i].id);return e},onSubmit:function(){var t=this;if(this.$v.linkForm.$touch(),this.$v.linkForm.$anyError)console.log("ERROR");else{var e=this.markedList(this.users),n=this.markedList(this.courses),r=this.markedList(this.groups),o=this.markedList(this.problems),l=[];if(e.length>0&&n.length>0){var m={skey:"courses",svalue:n,dkey:"users",dvalue:e};l.push(m)}if(n.length>0&&r.length>0){var d={skey:"courses",svalue:n,dkey:"groups",dvalue:r};l.push(d)}if(r.length>0&&o.length>0){var c={skey:"groups",svalue:r,dkey:"problems",dvalue:o};l.push(c)}if(l.length>0){this.linkcount=l.length,this.linkok=0,console.log("Prepare to call createLink");for(var i=0;i<l.length;i++)this.$store.dispatch("admin/createLink",l[i]).then((function(e){t.linkok=t.linkok+1})).catch((function(t){console.log("Create Link Error",link,t)}))}}},removeItem:function(data){var t=this;console.log("COME",data),this.$store.commit("admin/toggleItem",data),this.$store.commit("admin/toggleMark"),this.$nextTick((function(){t.$store.commit("admin/toggleMark")}))}},computed:{disable:function(){return this.linkcount!=this.linkok},users:function(){return this.$store.state.admin.users},courses:function(){return this.$store.state.admin.courses},groups:function(){return this.$store.state.admin.groups},problems:function(){return this.$store.state.admin.problems},submits:function(){return this.$store.state.admin.submits},mark:function(){return this.$store.state.admin.mark}}},m=(n(373),n(15)),component=Object(m.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"admin-layout"},[n("section",{staticClass:"list-area"},[n("nuxt-child")],1),t._v(" "),t.mark?n("section",{staticClass:"mark-area"},[n("b-row",[n("b-col",{staticClass:"users"},[n("h4",[t._v("使用者")]),t._v(" "),n("ol",t._l(t.users,(function(e,r){return n("div",{key:r},[e.mark?n("li",[t._v("\n              (\n              "),n("b-link",{attrs:{size:"sm"},on:{click:function(n){return t.removeItem({dkey:"users",dvalue:e.id})}}},[n("fa",{attrs:{icon:["far","trash-alt"]}})],1),t._v("\n              ) \n              "+t._s(e.name)+"\n            ")],1):t._e()])})),0)]),t._v(" "),n("b-col",{staticClass:"courses"},[n("h4",[t._v("課程")]),t._v(" "),n("ol",t._l(t.courses,(function(e,r){return n("div",{key:r},[e.mark?n("li",[t._v("\n              (\n              "),n("b-link",{attrs:{size:"sm"},on:{click:function(n){return t.removeItem({dkey:"courses",dvalue:e.id})}}},[n("fa",{attrs:{icon:["far","trash-alt"]}})],1),t._v("\n              ) \n              "+t._s(e.name)+"\n            ")],1):t._e()])})),0)]),t._v(" "),n("b-col",{staticClass:"groups"},[n("h4",[t._v("題組")]),t._v(" "),n("ol",t._l(t.groups,(function(e,r){return n("div",{key:r},[e.mark?n("li",[t._v("\n              (\n              "),n("b-link",{attrs:{size:"sm"},on:{click:function(n){return t.removeItem({dkey:"groups",dvalue:e.id})}}},[n("fa",{attrs:{icon:["far","trash-alt"]}})],1),t._v("\n              ) \n              "+t._s(e.name)+"\n            ")],1):t._e()])})),0)]),t._v(" "),n("b-col",{staticClass:"problems"},[n("h4",[t._v("題目")]),t._v(" "),n("ol",t._l(t.problems,(function(e,r){return n("div",{key:r},[e.mark?n("li",[t._v("\n              (\n              "),n("b-link",{attrs:{size:"sm"},on:{click:function(n){return t.removeItem({dkey:"problems",dvalue:e.id})}}},[n("fa",{attrs:{icon:["far","trash-alt"]}})],1),t._v("\n              ) \n              "+t._s(e.name)+"\n            ")],1):t._e()])})),0)]),t._v(" "),n("b-col",{staticClass:"link"},[n("h4",[t._v("操作")]),t._v(" "),n("b-form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[n("b-form-group",{attrs:{id:"start"}},[n("b-form-input",{attrs:{id:"start",placeholder:"YYYY-MM-DD HH:MM:SS",state:t.$v.linkForm.start.$dirty?!t.$v.linkForm.start.$error:null,size:"sm"},model:{value:t.$v.linkForm.start.$model,callback:function(e){t.$set(t.$v.linkForm.start,"$model",e)},expression:"$v.linkForm.start.$model"}})],1),t._v(" "),n("b-form-group",{attrs:{id:"end"}},[n("b-form-input",{attrs:{id:"end",placeholder:"YYYY-MM-DD HH:MM:SS",state:t.$v.linkForm.end.$dirty?!t.$v.linkForm.end.$error:null,size:"sm"},model:{value:t.$v.linkForm.end.$model,callback:function(e){t.$set(t.$v.linkForm.end,"$model",e)},expression:"$v.linkForm.end.$model"}})],1),t._v(" "),n("b-form-group",{attrs:{id:"status"}},[n("b-form-select",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"status",options:t.statuses,size:"sm"},model:{value:t.$v.linkForm.status.$model,callback:function(e){t.$set(t.$v.linkForm.status,"$model",e)},expression:"$v.linkForm.status.$model"}})],1),t._v(" "),n("b-button",{attrs:{size:"sm",pill:"",block:"",type:"submit",variant:"outline-primary",disabled:t.disable}},[t._v("\n            建立連結\n            "),t.disable?n("b-spinner",{staticStyle:{width:"1.3rem",height:"1.3rem"}}):t._e()],1)],1)],1)],1)],1):t._e()])}),[],!1,null,"40252806",null);e.default=component.exports}}]);