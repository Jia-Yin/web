(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{322:function(t,e,r){var content=r(370);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(28).default)("328b20e9",content,!0,{sourceMap:!1})},369:function(t,e,r){"use strict";var n=r(322);r.n(n).a},370:function(t,e,r){(t.exports=r(27)(!1)).push([t.i,"h4[data-v-0493788f]{color:#00f;font-size:100%;text-decoration:underline}form[data-v-0493788f]{margin-top:30px;width:90%}.mark-area[data-v-0493788f]{width:100%;position:fixed;bottom:0;height:33%;overflow:auto}.users[data-v-0493788f]{background:#e0ffff}.courses[data-v-0493788f]{background:#ffffe0}.groups[data-v-0493788f]{background:#e0ffff}.problems[data-v-0493788f]{background:#ffffe0}.link[data-v-0493788f]{background:#ffb6c1;min-height:280px}",""])},407:function(t,e,r){"use strict";r.r(e);var n=r(320),o=r(319).helpers.regex("fullTime",/^\d\d\d\d-\d\d-\d\d\s\d\d:\d\d:\d\d\s*$/),l={layout:"adminLayout",mixins:[n.validationMixin],data:function(){return{linkcount:0,linkok:0,linkForm:{start:null,end:null,status:!0},statuses:[{text:"開放狀態",value:null},{text:"開放",value:!0},{text:"不開放",value:!1}]}},validations:{linkForm:{start:{fullTime:o},end:{fullTime:o},status:{}}},methods:{markedList:function(t){var e=[];if(t)for(var i=0;i<t.length;i++)t[i].mark&&e.push(t[i].id);return e},onSubmit:function(){var t=this;if(this.$v.linkForm.$touch(),this.$v.linkForm.$anyError)console.log("ERROR");else{var e=this.markedList(this.users),r=this.markedList(this.courses),n=this.markedList(this.groups),o=this.markedList(this.problems),l=[];if(e.length>0&&r.length>0){var m={skey:"courses",svalue:r,dkey:"users",dvalue:e};l.push(m)}if(r.length>0&&n.length>0){var d={skey:"courses",svalue:r,dkey:"groups",dvalue:n};l.push(d)}if(n.length>0&&o.length>0){var c={skey:"groups",svalue:n,dkey:"problems",dvalue:o};l.push(c)}if(l.length>0){this.linkcount=l.length,this.linkok=0,console.log("Prepare to call createLink");for(var i=0;i<l.length;i++)this.$store.dispatch("admin/createLink",l[i]).then((function(e){t.linkok=t.linkok+1})).catch((function(t){console.log("Create Link Error",link,t)}))}}},removeItem:function(data){var t=this;console.log("COME",data),this.$store.commit("admin/toggleItem",data),this.$store.commit("admin/toggleMark"),this.$nextTick((function(){t.$store.commit("admin/toggleMark")}))}},computed:{disable:function(){return this.linkcount!=this.linkok},users:function(){return this.$store.state.admin.users},courses:function(){return this.$store.state.admin.courses},groups:function(){return this.$store.state.admin.groups},problems:function(){return this.$store.state.admin.problems},submits:function(){return this.$store.state.admin.submits},mark:function(){return this.$store.state.admin.mark}},mounted:function(){this.$store.state.user?"admin"!=this.$store.state.user.role&&this.$router.push("/user"):this.$router.push("/login")}},m=(r(369),r(15)),component=Object(m.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"admin-layout"},[r("section",{staticClass:"list-area"},[r("nuxt-child")],1),t._v(" "),t.mark?r("section",{staticClass:"mark-area"},[r("b-row",[r("b-col",{staticClass:"users"},[r("h4",[t._v("使用者")]),t._v(" "),r("ol",t._l(t.users,(function(e,n){return r("div",{key:n},[e.mark?r("li",[t._v("\n              (\n              "),r("b-link",{attrs:{size:"sm"},on:{click:function(r){return t.removeItem({dkey:"users",dvalue:e.id})}}},[r("fa",{attrs:{icon:["far","trash-alt"]}})],1),t._v("\n              ) \n              "+t._s(e.name)+"\n            ")],1):t._e()])})),0)]),t._v(" "),r("b-col",{staticClass:"courses"},[r("h4",[t._v("課程")]),t._v(" "),r("ol",t._l(t.courses,(function(e,n){return r("div",{key:n},[e.mark?r("li",[t._v("\n              (\n              "),r("b-link",{attrs:{size:"sm"},on:{click:function(r){return t.removeItem({dkey:"courses",dvalue:e.id})}}},[r("fa",{attrs:{icon:["far","trash-alt"]}})],1),t._v("\n              ) \n              "+t._s(e.name)+"\n            ")],1):t._e()])})),0)]),t._v(" "),r("b-col",{staticClass:"groups"},[r("h4",[t._v("題組")]),t._v(" "),r("ol",t._l(t.groups,(function(e,n){return r("div",{key:n},[e.mark?r("li",[t._v("\n              (\n              "),r("b-link",{attrs:{size:"sm"},on:{click:function(r){return t.removeItem({dkey:"groups",dvalue:e.id})}}},[r("fa",{attrs:{icon:["far","trash-alt"]}})],1),t._v("\n              ) \n              "+t._s(e.name)+"\n            ")],1):t._e()])})),0)]),t._v(" "),r("b-col",{staticClass:"problems"},[r("h4",[t._v("題目")]),t._v(" "),r("ol",t._l(t.problems,(function(e,n){return r("div",{key:n},[e.mark?r("li",[t._v("\n              (\n              "),r("b-link",{attrs:{size:"sm"},on:{click:function(r){return t.removeItem({dkey:"problems",dvalue:e.id})}}},[r("fa",{attrs:{icon:["far","trash-alt"]}})],1),t._v("\n              ) \n              "+t._s(e.name)+"\n            ")],1):t._e()])})),0)]),t._v(" "),r("b-col",{staticClass:"link"},[r("h4",[t._v("操作")]),t._v(" "),r("b-form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[r("b-form-group",{attrs:{id:"start"}},[r("b-form-input",{attrs:{id:"start",placeholder:"YYYY-MM-DD HH:MM:SS",state:t.$v.linkForm.start.$dirty?!t.$v.linkForm.start.$error:null,size:"sm"},model:{value:t.$v.linkForm.start.$model,callback:function(e){t.$set(t.$v.linkForm.start,"$model",e)},expression:"$v.linkForm.start.$model"}})],1),t._v(" "),r("b-form-group",{attrs:{id:"end"}},[r("b-form-input",{attrs:{id:"end",placeholder:"YYYY-MM-DD HH:MM:SS",state:t.$v.linkForm.end.$dirty?!t.$v.linkForm.end.$error:null,size:"sm"},model:{value:t.$v.linkForm.end.$model,callback:function(e){t.$set(t.$v.linkForm.end,"$model",e)},expression:"$v.linkForm.end.$model"}})],1),t._v(" "),r("b-form-group",{attrs:{id:"status"}},[r("b-form-select",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"status",options:t.statuses,size:"sm"},model:{value:t.$v.linkForm.status.$model,callback:function(e){t.$set(t.$v.linkForm.status,"$model",e)},expression:"$v.linkForm.status.$model"}})],1),t._v(" "),r("b-button",{attrs:{size:"sm",pill:"",block:"",type:"submit",variant:"outline-primary",disabled:t.disable}},[t._v("\n            建立連結\n            "),t.disable?r("b-spinner",{staticStyle:{width:"1.3rem",height:"1.3rem"}}):t._e()],1)],1)],1)],1)],1):t._e()])}),[],!1,null,"0493788f",null);e.default=component.exports}}]);