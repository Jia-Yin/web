(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{398:function(t,r,e){var content=e(461);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,e(31).default)("7abe49f1",content,!0,{sourceMap:!1})},460:function(t,r,e){"use strict";var o=e(398);e.n(o).a},461:function(t,r,e){(t.exports=e(30)(!1)).push([t.i,"input[data-v-b6346a76]{margin-left:12px;line-height:200%;border-radius:10px;width:300px;vertical-align:bottom}.row[data-v-b6346a76]{margin:32px 0 18px}",""])},509:function(t,r,e){"use strict";e.r(r);e(25),e(3),e(1),e(5),e(22),e(41);var o,n=e(10),h={data:function(){return{isMounted:!1,qstr:"",whichcourse:"",allcourses:[{text:"全部課程",value:""}],whichgroup:""}},mounted:(o=Object(n.a)(regeneratorRuntime.mark((function t(){var r,e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=0,this.$store.state.admin.courses?r++:this.$store.dispatch("admin/getCollection","courses").then((function(){r++;for(var t=e.$store.state.admin.courses,i=0;i<t.length;i++){var o={text:t[i].name,value:t[i].id};e.allcourses.push(o)}3==r&&(e.isMounted=!0)})),this.$store.state.admin.users?r++:this.$store.dispatch("admin/getCollection","users").then((function(){3==++r&&(e.isMounted=!0)})),this.$store.state.admin.groups?r++:this.$store.dispatch("admin/getCollection","groups").then((function(){3==++r&&(e.isMounted=!0)})),3==r&&(this.isMounted=!0);case 5:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),methods:{lookuser:function(t){this.$store.commit("person/clearData"),this.$store.commit("setData",{key:"comuser",value:t}),this.$router.push("/admin/user/look")},toggleMark:function(){this.$store.commit("admin/toggleMark")},toggleItem:function(t){var r=this;this.$store.commit("admin/toggleItem",{dkey:"users",dvalue:t.id}),this.toggleMark(),this.$nextTick((function(){r.toggleMark()}))},role:function(t){return t||"學生"},allpass:function(t){if(""==this.whichgroup)return t&&t.solved?t.solved.length:0;if(!t||!t.solved)return 0;for(var r,i=0;i<this.groups.length;i++)if(this.whichgroup==this.groups[i].id){r=this.groups[i];break}var e=r.problems,o=0;if(!e)return 0;for(var n=0;n<e.length;n++)t.solved.indexOf(e[n])>=0&&o++;return o},allsubmits:function(t){if(""==this.whichgroup)return t&&t.submits?Object.keys(t.submits).length:0;if(!t||!t.submits)return 0;for(var r,i=0;i<this.groups.length;i++)if(this.whichgroup==this.groups[i].id){r=this.groups[i];break}var e=r.problems,o=0;if(!e)return 0;for(var n=0;n<e.length;n++)t.submits[e[n]]&&o++;return o},allsubmitscount:function(t){if(""==this.whichgroup)return t&&t.submits?Object.keys(t.submits).map((function(r){return t.submits[r].length})).reduce((function(a,b){return a+b}),0):0;if(!t||!t.submits)return 0;for(var r,i=0;i<this.groups.length;i++)if(this.whichgroup==this.groups[i].id){r=this.groups[i];break}var e=r.problems,o=0;if(!e)return 0;for(var n=0;n<e.length;n++)t.submits[e[n]]&&(o+=t.submits[e[n]].length);return o},allontimesubmits:function(t){if(""===this.whichgroup)return"none";if(!t||!t.submits)return 0;for(var r,i=0;i<this.groups.length;i++)if(this.whichgroup==this.groups[i].id){r=this.groups[i];break}var e=r.problems,o=0;if(!e)return 0;for(var n=0;n<e.length;n++)t.submits[e[n]]&&this.onTimeCheck(t,e[n])&&o++;return o},sum:function(t){for(var r=0,i=0;i<t.length;i++)r+=this.allsubmitscount(t[i]);return r},psolved:function(t,r){return!(!t.solved||0===t.solved.length)&&t.solved.indexOf(r)>=0},onTimeCheck:function(t,r){var e,o=this.$store.state.admin.groups;if(!o)return 0;for(var i=0;i<o.length;i++)if(this.whichgroup==o[i].id){e=o[i];break}if(void 0===e.time)return this.psolved(t,r)?1:0;if(null==e.time.end)return this.psolved(t,r)?1:0;if(this.psolved(t,r))for(var n=e.time.start,h=e.time.end,l=0;l<t.submits[r].length;l++){var c=t.submits[r][l];console.log("User, Submit Item",t.id,c);var v=c.split("/");if("1"===v[1]){var m=v[0].substr(0,8)+v[0].substr(8);if(n<=m&&m<=h)return" (準時)";if(null==n&&m<=h)return" (準時)"}}return 0}},computed:{mark:function(){return this.$store.state.admin.mark},users:function(){if(""===this.qstr){if(""===this.whichcourse)return this.$store.state.admin.users;for(var t,r=this.$store.state.admin.courses,e=this.$store.state.admin.users,o=[],i=0;i<r.length;i++)if(r[i].id===this.whichcourse){t=r[i].users;break}for(var n=0;n<t.length;n++)for(var h=0;h<e.length;h++)e[h].id===t[n]&&o.push(e[h]);return o}if(""===this.whichcourse)return this.$store.getters["admin/filter"]({dkey:"users",dvalue:this.qstr});for(var l,c=this.$store.state.admin.courses,v=this.$store.getters["admin/filter"]({dkey:"users",dvalue:this.qstr}),m=[],f=0;f<c.length;f++)if(c[f].id===this.whichcourse){l=c[f].users;break}for(var d=0;d<l.length;d++)for(var _=0;_<v.length;_++)v[_].id===l[d]&&m.push(v[_]);return m},submits:function(){return this.$store.state.admin.submits},groups:function(){var t=[];if(""===this.whichcourse){var r=this.$store.state.admin.groups;if(r)for(var i=0;i<r.length;i++)t.push(r[i]);return t}for(var e,o=this.$store.state.admin.courses,n=this.$store.state.admin.groups,h=[],l=0;l<o.length;l++)if(o[l].id===this.whichcourse){e=o[l].groups;break}for(var c=0;c<e.length;c++)for(var v=0;v<n.length;v++)n[v].id===e[c]&&h.push(n[v]);return h},optgroups:function(){this.whichgroup="";var t=[{text:"全部單元",value:""}],r=this.groups;if(r)for(var i=0;i<r.length;i++){var e={text:r[i].name,value:r[i].id};t.push(e)}return t}}},l=(e(460),e(16)),component=Object(l.a)(h,(function(){var t=this,r=t.$createElement,e=t._self._c||r;return t.isMounted?e("b-container",{attrs:{fluid:""}},[e("b-row",[e("span",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.qstr,expression:"qstr"}],attrs:{type:"text",placeholder:" 搜尋..."},domProps:{value:t.qstr},on:{input:function(r){r.target.composing||(t.qstr=r.target.value)}}}),t._v("  \n      "),e("b-button",{attrs:{pill:"",variant:"outline-warning"}},[t._v("新增")]),t._v(" "),t.mark?e("span",[e("b-button",{attrs:{pill:"",variant:"primary"},on:{click:function(r){return t.toggleMark()}}},[t._v("標記")])],1):e("span",[e("b-button",{attrs:{pill:"",variant:"outline-primary"},on:{click:function(r){return t.toggleMark()}}},[t._v("標記")])],1)],1)]),t._v(" "),e("b-row",[e("b-form-select",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"whichcourse",options:t.allcourses,size:"sm"},model:{value:t.whichcourse,callback:function(r){t.whichcourse=r},expression:"whichcourse"}})],1),t._v(" "),e("b-row",[e("b-form-select",{staticClass:"mb-2 mr-sm-2 mb-sm-0",attrs:{id:"whichgroup",options:t.optgroups,size:"sm"},model:{value:t.whichgroup,callback:function(r){t.whichgroup=r},expression:"whichgroup"}})],1),t._v(" "),e("table",{staticClass:"table table-hover table-striped"},[e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("#")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("姓名")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("學號")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("科系")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("年級")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("類型")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("總提交("+t._s(t.sum(t.users))+")")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("作答題目")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("通過")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("準時提交")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("操作")])])]),t._v(" "),e("tbody",t._l(t.users,(function(r,o){return e("tr",{key:o},[e("td",[t._v(t._s(o+1))]),t._v(" "),e("td",[t._v(t._s(r.name))]),t._v(" "),e("td",[t._v(t._s(r.stdID))]),t._v(" "),e("td",[t._v(t._s(r.dept))]),t._v(" "),e("td",[t._v(t._s(r.grade))]),t._v(" "),e("td",[t._v(t._s(t.role(r.role)))]),t._v(" "),e("td",[t._v(t._s(t.allsubmitscount(r)))]),t._v(" "),e("td",[t._v(t._s(t.allsubmits(r)))]),t._v(" "),e("td",[t._v(t._s(t.allpass(r)))]),t._v(" "),e("td",[t._v(t._s(t.allontimesubmits(r)))]),t._v(" "),e("td",[t.mark?e("span",[e("b-form-checkbox",{attrs:{checked:r.mark},on:{change:function(e){return t.toggleItem(r)}}})],1):e("span",[e("b-button",{attrs:{size:"sm",pill:"",variant:"outline-primary"},on:{click:function(e){return t.lookuser(r)}}},[e("fa",{attrs:{icon:["far","eye"]}})],1),t._v(" "),e("b-button",{attrs:{size:"sm",pill:"",variant:"outline-warning",to:"/admin/user"}},[e("fa",{attrs:{icon:["far","trash-alt"]}})],1)],1)])])})),0)])],1):t._e()}),[],!1,null,"b6346a76",null);r.default=component.exports}}]);