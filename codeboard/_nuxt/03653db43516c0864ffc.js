(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{335:function(t,e,o){var content=o(392);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(28).default)("b6e4a8ea",content,!0,{sourceMap:!1})},391:function(t,e,o){"use strict";var n=o(335);o.n(n).a},392:function(t,e,o){(t.exports=o(27)(!1)).push([t.i,".container-fluid[data-v-26d59d30]{padding:0}.btn[data-v-26d59d30]{margin-right:12px}.timeLeft[data-v-26d59d30]{color:#ff0}.ptitle[data-v-26d59d30]{padding:3px;background:#00f;color:#fff;margin:12px 0 6px;text-align:center}.pseg[data-v-26d59d30]{display:inline-block;margin-top:8px;background:orange;color:#00f;padding:3px}.psample[data-v-26d59d30]{margin:6px 0;background:#eee;color:#000;padding:3px 8px;font-family:Courier New,Courier,monospace}label[data-v-26d59d30]{color:#fff}.container[data-v-26d59d30]{width:100%;margin:0 auto;padding:50px 0;text-align:left}ul.stcheck[data-v-26d59d30]{margin:6px 0;background:#eee;color:#000;padding:6px 0 10px 30px}.vue-codemirror[data-v-26d59d30]{border:1px solid #eee}.headlabel[data-v-26d59d30]{display:inline-block;color:#ff0;text-align:right;margin-left:24px}.probPanel[data-v-26d59d30]{padding:0 10px}",""])},418:function(t,e,o){"use strict";o.r(e);o(21),o(40);var n,r,l=o(10),c=(o(22),o(0)),d=(o(12),{layout:"codingLayout",middleware:["authenticated"],data:function(){var t;return{db:null,protocol:"",servers:null,maxavail:0,pid:null,trial:!1,status:"Connecting...",tabIndex:0,disabled:!1,timerStart:!1,time:null,cmobject:null,spentTime:0,cmstyle:{"font-size":"100%"},cmfontsize:100,watchInterval:10,errorcase:null,lastcode:"",frameIndex:0,firebaseHost:"",hostOptions:[{value:"localhost:8080",text:"default"},{value:"140.135.13.120:8080",text:"EE401 "},{value:"140.135.13.999:8080",text:"test01"}],info:{RunStatus:"Not Available",StyleCheck:"N/A"},options:[{value:"c",text:"C"},{value:"cpp",text:"C++"}],form:{language:"c",code:"",problem:"00000001"},codedata:{sourceCode:"",command:"",sourceLang:"",answerLang:"",answerCode:"",timeLimit:1,memoryLimit:1,testData:null},problem:{name:"Loading..."},code:"",cmOption:(t={tabSize:3,foldGutter:!0,styleActiveLine:!0,lineNumbers:!0,line:!0,matchBrackets:!0,indentWithTabs:!0,indentUnit:3,theme:"neat",scrollbarStyle:"native",keyMap:"sublime",mode:"text/x-c++src"},Object(c.a)(t,"theme","mdn-like"),Object(c.a)(t,"extraKeys",{F11:function(t){t.setOption("fullScreen",!t.getOption("fullScreen"))},Esc:function(t){t.getOption("fullScreen")&&t.setOption("fullScreen",!1)}}),t)}},mounted:function(){this.$store.state.user||this.$router.push("/login"),this.$store.state.person&&this.path&&this.path.problem||this.$router.push("/user"),this.checkServer(),this.loadPage(),this.$store.state.person.saveCodes[this.path.problem.id]&&(this.form.code=this.$store.state.person.saveCodes[this.path.problem.id])},computed:{admin:function(){return"admin"===this.$store.state.user.role},user:function(){return this.$store.state.user},courses:function(){return this.$store.state.person.courses},problems:function(){return this.$store.state.person.currentProblems},path:function(){return this.$store.state.person.path},statusResults:function(){var t="";return console.log("Received:",this.info.RunStatus),"AC"===this.info.RunStatus?t="正確，"+this.info.Score+"分":"WA"===this.info.RunStatus?(t="錯誤，"+this.info.Score+"分，錯誤範例如下\n",t+="\n輸入\n".concat(this.errorcase.input),t+="\n程式輸出\n".concat(this.errorcase.wrong),t+="\n正確輸出\n".concat(this.errorcase.right)):t="TLE"===this.info.RunStatus?"超過時間限制":"MLE"===this.info.RunStatus?"超過記憶體限制":this.info.RunStatus,t},styleResults:function(){console.log("STY COMEIN = ",this.info.StyleCheck);var t=/(\d+:)\s*/gi,a=this.info.StyleCheck.replace(t,"<li>L$1 ");t=/\n/gi;var e=a.replace(t,"</li>");return console.log("STY = ",e),e}},methods:{onCmCursorActivity:function(t){console.log("onCmCursorActivity",t)},onCmReady:function(t){console.log("codemirror object",t),this.cmobject=t,t.setSize(null,800),console.log("onCmReady",t)},onCmFocus:function(t){console.log("onCmFocus",t)},onCmBlur:function(t){console.log("onCmBlur",t)},incfont:function(){this.cmfontsize+=10,this.cmstyle={"font-size":"".concat(this.cmfontsize,"%")}},decfont:function(){this.cmfontsize-=10,this.cmstyle={"font-size":"".concat(this.cmfontsize,"%")}},resetfont:function(){this.cmfontsize=100,this.cmstyle={"font-size":"".concat(this.cmfontsize,"%")}},str2html:function(t){return t?t.replace("\n","<br>"):null},loadPage:(r=Object(l.a)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,t.prev=1,t.next=4,this.$store.dispatch("person/getProblem",this.path.problem).then((function(t){if(console.log("Pdata",t),e.problem.name=t.name,e.problem.description=t.description,e.problem.testData=t.testdata,e.problem.tLimit=1,null!=t.timelimit&&(e.problem.tLimit=t.timelimit),e.problem.mLimit=1,null!=t.memorylimit&&(e.problem.mLimit=t.memorylimit),e.codedata.timeLimit=e.problem.tLimit,e.codedata.memoryLimit=e.problem.mLimit,e.codedata.answerLang=t.answerlang,t.answercode){var o=t.answercode.replace(/\\\\n/g,"@Q@Q@");o=(o=(o=(o=o.replace(/\\n/g,"\n")).replace(/@Q@Q@/g,"\\n")).replace(/\\"/g,'"')).replace(/\\'/g,"'"),e.codedata.answerCode=o}if(t.samples){var n=JSON.parse(t.samples);e.problem.sampleInput=n[0].Input,e.problem.sampleOutput=n[0].Output}else e.problem.sampleInput="N/A",e.problem.sampleOutput="N/A"}));case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),console.error(t.t0);case 9:this.tabIndex=0;case 10:case"end":return t.stop()}}),t,this,[[1,6]])}))),function(){return r.apply(this,arguments)}),checkServer:(n=Object(l.a)(regeneratorRuntime.mark((function t(){var e,o,i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$store.state.servers){t.next=3;break}return t.next=3,this.$store.dispatch("getServers").then((function(t){console.log("Get SERVER RESULT:",t)})).catch((function(t){console.log("Get SERVER ERROR:",t)}));case 3:for(e="ws://","https:"==document.location.protocol?(this.servers=this.$store.state.servers.https,e="wss://"):this.servers=this.$store.state.servers.http,o=this.servers.length,i=0;i<o;i++)n=e+this.servers[i],this.sendMessage(n,"HELLO"+i);case 7:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),timer:function(){var t=this;this.time=setInterval((function(){t.spentTime++,t.spentTime%t.watchInterval==0&&t.recordCode()}),1e3)},setTime:function(){this.timerStart&&clearInterval(this.time)},parseMessage:function(t){console.log("To Parse: ",t);var data=JSON.parse(t.data);if("string"==typeof data&&"HELLO:"===data.substr(0,6)){var e=data.substr(6),o=e.indexOf(":");console.log("SERVER NO = ",e.substr(0,o)),console.log("NUMSTR = ",e.substr(o+1));var n=parseInt(e.substr(o+1),10);console.log("NUM = ",n),n>this.maxavail&&(this.maxavail=n,this.protocol=t.origin,this.status="SRV-"+e.substr(0,o),console.log("Choose Server:",this.protocol))}else try{this.info=JSON.parse(t.data);var r=this.info.RunStatus;if(r.indexOf("error")>=0?r="CE":"AC"!=r&&(r="WA",this.errorcase=this.info.ErrorCase,console.log("ERRORCASE",this.errorcase)),!this.trial){var l={user:this.user.id,problem:this.path.problem.id,code:this.form.code,status:r,score:this.info.Score};this.$store.dispatch("person/submit",l)}}catch(t){alert(t)}this.trial=!1},save:function(t){t.preventDefault(),this.codedata.sourceCode=this.form.code;JSON.stringify(this.codedata);this.$store.commit("person/saveCode",{id:this.path.problem.id,code:this.form.code}),alert("已儲存到暫存區！")},judge:function(t){if(this.form.code.length<10)alert("請先寫好程式碼再繳交！");else{this.tabIndex=1,this.disabled=!0;try{var e=JSON.parse(this.problem.testData)}catch(t){return alert(t),!1}this.codedata.sourceCode=this.form.code,this.codedata.sourceLang=this.form.language,this.codedata.testData=e;var content=JSON.stringify(this.codedata);this.$store.commit("person/saveCode",{id:this.path.problem.id,code:this.form.code}),this.trial=!t,this.sendMessage(this.protocol,"CODE:"+content)}},sendMessage:function(t,content){var e=this,o=new WebSocket(t+"/submit");o.onopen=function(t){console.log("WS open and send:",content),o.send(content)},o.onmessage=function(t){console.log("Receive:",t.data),e.parseMessage(t),e.disabled=!1,o.close()},o.onclose=function(t){console.log("WS closed:",t)},o.onerror=function(t){console.log("Socket ERR:",t),o.close()}}}}),m=(o(391),o(15)),component=Object(m.a)(d,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-container",{attrs:{fluid:""}},[o("b-navbar",{attrs:{type:"dark",variant:"primary"}},[o("b-navbar-brand",{attrs:{to:"/"}},[t._v("CTRL OJ")]),t._v(" "),o("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),t._v(" "),o("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[o("b-navbar-nav",[t.path.course?o("b-nav-item",{attrs:{href:"#"}},[o("span",{staticClass:"headlabel"},[t._v(t._s(t.path.course.name))])]):t._e(),t._v(" "),t.path.group?o("b-nav-item",{attrs:{href:"#"}},[o("span",{staticClass:"headlabel"},[t._v(t._s(t.path.group.name))])]):t._e(),t._v(" "),t.path.problem?o("b-nav-item",{attrs:{href:"#"}},[o("span",{staticClass:"headlabel"},[t._v(t._s(t.path.problem.name))])]):t._e()],1),t._v(" "),o("b-navbar-nav",{staticClass:"ml-auto"},[o("b-nav-form",[t.disabled?o("b-spinner",{attrs:{small:""}}):t._e(),t._v(" "),o("b-button",{attrs:{variant:"success",disabled:t.disabled},on:{click:t.decfont}},[t._v("-")]),t._v(" "),o("b-button",{attrs:{variant:"success",disabled:t.disabled},on:{click:t.resetfont}},[t._v("o")]),t._v(" "),o("b-button",{attrs:{variant:"success",disabled:t.disabled},on:{click:t.incfont}},[t._v("+")]),t._v(" "),o("b-button",{attrs:{variant:"success",disabled:t.disabled},on:{click:t.save}},[t._v("暫存")]),t._v(" "),t.admin?o("b-button",{attrs:{variant:"success",disabled:t.disabled},on:{click:function(e){return t.judge(!1)}}},[t._v("試做")]):t._e(),t._v(" "),o("b-button",{attrs:{variant:"success",disabled:t.disabled},on:{click:function(e){return t.judge(!0)}}},[t._v("提交")]),t._v(" "),o("b-button",{attrs:{variant:"success",to:"/user"}},[t._v("回主畫面")]),t._v(" "),o("b-form-select",{attrs:{options:t.options,size:"sm"},model:{value:t.form.language,callback:function(e){t.$set(t.form,"language",e)},expression:"form.language"}})],1),t._v("  \n        "),o("b-nav-item",[t._v(t._s(t.status))]),t._v(" "),o("b-nav-item",{staticClass:"timeLeft"},[t._v("剩餘時間 : INF")])],1),t._v(" "),o("b-navbar-nav",{staticClass:"ml-auto"},[o("b-nav-item",[o("span",{staticClass:"headlabel"},[t._v(t._s(t.user.name))])])],1)],1)],1),t._v(" "),o("div",[o("Split",{staticStyle:{height:"805px"},attrs:{gutterSize:5}},[o("SplitArea",{attrs:{size:25,minSize:300}},[o("b-tabs",{model:{value:t.tabIndex,callback:function(e){t.tabIndex=e},expression:"tabIndex"}},[o("b-tab",{attrs:{title:"問題說明"}},[o("div",{staticClass:"probPanel"},[o("p",{staticClass:"ptitle"},[t._v(t._s(t.problem.name))]),t._v(" "),o("p",[t._v(t._s(t.problem.description))]),t._v(" "),o("span",{staticClass:"pseg"},[t._v("條件限制")]),t._v(" "),o("p",{staticClass:"psample"},[t._v("時間＜"+t._s(t.problem.tLimit)+"秒 記憶體＜"+t._s(t.problem.mLimit)+"M")]),t._v(" "),o("span",{staticClass:"pseg"},[t._v("範例輸入")]),t._v(" "),o("p",{staticClass:"psample"},[o("span",{domProps:{innerHTML:t._s(t.str2html(t.problem.sampleInput))}})]),t._v(" "),o("span",{staticClass:"pseg"},[t._v("範例輸出")]),t._v(" "),o("p",{staticClass:"psample"},[o("span",{domProps:{innerHTML:t._s(t.str2html(t.problem.sampleOutput))}})])])]),t._v(" "),o("b-tab",{attrs:{title:"評判結果"}},[o("div",{staticClass:"probPanel"},[o("span",{staticClass:"pseg"},[t._v("執行結果")]),t._v(" "),o("pre",{staticClass:"psample"},[t._v(t._s(t.statusResults))]),t._v(" "),o("br"),t._v(" "),o("span",{staticClass:"pseg"},[t._v("風格檢查")]),t._v(" "),""==t.info.StyleCheck?o("p",{staticClass:"psample"},[t._v("檢查通過")]):o("ul",{staticClass:"stcheck",domProps:{innerHTML:t._s(t.styleResults)}})])])],1)],1),t._v(" "),o("SplitArea",{attrs:{size:75,minSize:500}},[o("no-ssr",[o("codemirror",{style:t.cmstyle,attrs:{options:t.cmOption},on:{ready:t.onCmReady},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1)],1)],1)],1)],1)}),[],!1,null,"26d59d30",null);e.default=component.exports}}]);