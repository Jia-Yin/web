(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{1080:function(e,t,r){var content=r(1265);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(61).default)("d468b84e",content,!0,{sourceMap:!1})},1264:function(e,t,r){"use strict";r(1080)},1265:function(e,t,r){(t=r(60)(!1)).push([e.i,".rightBox[data-v-7cd01acb]{position:absolute;right:32px;top:14px;width:120px}.tabs[data-v-7cd01acb]{margin-right:60px}.container-fluid[data-v-7cd01acb]{position:relative}",""]),e.exports=t},1339:function(e,t,r){"use strict";r.r(t);r(39),r(156),r(29),r(49);var n=r(7),o=r(844),c=r(852),d=r(32),l={components:{ProblemSolver:c.default},asyncData:function(e){return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.store,n=r.state.params.probSet,t.abrupt("return",{probSet:n});case 3:case"end":return t.stop()}}),t)})))()},data:function(){return{submitid:"",submitList:null,problem:null,baseProblems:null,demo:!1,pgKey:"Coding",lang:"c",langs:"c,cpp,py",initCode:"",lastcode:{},localeText:{Coding_Problem:"問題",Coding_Code:"程式",Coding_Result:"結果",Coding_Reference:"參考"}}},computed:{teaching:function(){var e=this.$user("role");return"teacher"==e||"assistant"==e}},created:function(){this.localeText=this.$updateLocaleText(this.localeText),this.problem=o.a.decode(this.pgKey,this.probSet.problem),this.probSet.initCode&&(this.initCode=this.probSet.initCode.code,this.lang=this.probSet.initCode.lang,this.lastcode={sourceLang:this.lang,sourceCode:this.initCode}),this.probSet.demo&&(this.demo=!0)},methods:{getBaseProblems:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.baseProblems){t.next=5;break}return t.next=3,d.d.collection("problems").doc("BASE").get();case 3:r=t.sent,e.baseProblems=r.data();case 5:case"end":return t.stop()}}),t)})))()},doSubmit:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t.problem=e.problem,t.lang=e.lang,t.initCode="",t.$nextTick((function(){t.initCode=e.code})),t.demo=!0;case 5:case"end":return r.stop()}}),r)})))()},searchSubmit:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,o,c,l,m,f,i,h,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((r=e.submitid.length)<4)){t.next=4;break}return alert("Code should have 4 chars!"),t.abrupt("return");case 4:return n=e.submitid.charCodeAt(r-1),o=e.submitid.substr(0,r-1)+String.fromCharCode(n+1),t.next=8,d.d.collection("submits").where(d.b.firestore.FieldPath.documentId(),">",e.submitid).where(d.b.firestore.FieldPath.documentId(),"<",o).get();case 8:if(!(c=t.sent).empty){t.next=12;break}return alert("No Match Results!"),t.abrupt("return");case 12:return l=c.docs,t.next=15,e.getBaseProblems();case 15:if(1!=l.length){t.next=20;break}return(m=l[0].data()).problem=e.baseProblems[m.pid],e.doSubmit(m),t.abrupt("return");case 20:f=[],i=0;case 22:if(!(i<l.length)){t.next=33;break}return(h=l[i].data()).problem=e.baseProblems[h.pid],t.next=27,d.d.collection("users").doc(h.uid).get();case 27:v=t.sent,h.user=v.data(),f.push(h);case 30:i++,t.next=22;break;case 33:e.submitList=f;case 34:case"end":return t.stop()}}),t)})))()},submit:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,c,l,m,f,h,v,x,S,k,C,w,y,i,_,O,P,D,M,T;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.cdata,c=e.result,n.sourceLang==t.lastcode.sourceLang&&n.sourceCode==t.lastcode.sourceCode){r.next=62;break}if(t.lastcode={sourceLang:n.sourceLang,sourceCode:n.sourceCode},l={uid:t.$user("id"),pid:t.problem.id,created:o.a.getNow(),lang:n.sourceLang,code:n.sourceCode,status:c.RunStatus,score:c.Score},!t.demo){r.next=7;break}return console.log("DEMO"),r.abrupt("return");case 7:return r.next=9,d.d.collection("submits").add(l);case 9:return m=r.sent,l.id=m.id,f=t.$user("id"),r.next=14,d.d.collection("users").doc(f).get();case 14:if(h=r.sent,(v=h.data()).id=f,t.$store.commit("setData",{name:"user",value:v}),(x=t.$user("courses")?t.$copyObject(t.$user("courses")):{})[t.probSet.courseID]&&x[t.probSet.courseID].units||(x[t.probSet.courseID]={name:t.probSet.courseName,units:{}}),x[t.probSet.courseID].units[t.probSet.courseUnit]||(x[t.probSet.courseID].units[t.probSet.courseUnit]={score:0,TS:0,TP:0,probs:{}}),S=x[t.probSet.courseID].units[t.probSet.courseUnit],(k=S.probs[l.pid])?C=t.$copyObject(k):(C={title:t.problem.title,TS:0,TP:0,score:0,last5:[]},S.probs[l.pid]=C),S.TS+=1,C.TS+=1,w="0/","AC"==l.status&&(S.TP+=1,C.TP+=1,w="1/"),!t.probSet.practice&&l.score>C.score&&(S.score+=l.score-C.score,C.score=l.score),C.last5.splice(0,0,w+l.id),!(C.last5.length>5)){r.next=45;break}if(!(C.last5[5].indexOf("1/")>=0)){r.next=44;break}y=!0,i=0;case 34:if(!(i<5)){r.next=41;break}if(!(C.last5[i].indexOf("1/")>=0)){r.next=38;break}return y=!1,r.abrupt("break",41);case 38:i++,r.next=34;break;case 41:y?C.last5.splice(4,1):C.last5.splice(5,1),r.next=45;break;case 44:C.last5.splice(5,1);case 45:return S.probs[l.pid]=C,r.next=48,d.d.collection("users").doc(t.$user("id")).update({courses:x,updated:o.a.getNow()});case 48:if(t.$store.commit("setObjItem",{obj:"user",name:"courses",value:x}),!t.probSet.practice){r.next=51;break}return r.abrupt("return");case 51:for(_=t.probSet.courseQN||3,O="queue"+(1+Math.floor(Math.random()*_)),P="P_"+o.a.getNow(),D=0;D<3;D++)P+=Math.floor(10*Math.random());return P+="_"+t.problem.id,(M={})[P]="AC"==l.status?1:0,T=t.$user(),M["S_"+T.id]={name:T.name,stdID:T.stdID,score:!0},r.next=62,d.d.collection("courses").doc(t.probSet.courseID).collection("tasks").doc(O).update(M);case 62:case"end":return r.stop()}}),r)})))()}}},m=(r(1264),r(55)),component=Object(m.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{staticClass:"mt-1",attrs:{fluid:""}},[e.teaching?r("p",{staticClass:"rightBox"},[r("b-input",{attrs:{size:"sm",placeholder:"SubmitID"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchSubmit(t)}},model:{value:e.submitid,callback:function(t){e.submitid=t},expression:"submitid"}})],1):e._e(),e._v(" "),r("b-modal",{model:{value:e.submitList,callback:function(t){e.submitList=t},expression:"submitList"}},[r("p",{staticClass:"my-3"},[e._v("Which one?")]),e._v(" "),e._l(e.submitList,(function(t,n){return r("p",{key:t.id},[e._v("\n                "+e._s(n+1)+". "+e._s(t.user.name)+" -\n                "+e._s(e.$selectUserLocaleText(t.problem.title))+"\n            ")])}))],2),e._v(" "),r("problem-solver",{attrs:{problem:e.problem,initCode:e.initCode,lang:e.lang,langs:e.langs},on:{submit:e.submit}})],1)}),[],!1,null,"7cd01acb",null);t.default=component.exports;installComponents(component,{ProblemSolver:r(852).default})},844:function(e,t,r){"use strict";r(10),r(14),r(22),r(86),r(9),r(845),r(27),r(15);var n=r(227),o=r.n(n),c={pad:function(e){return("0"+e).slice(-2)},mmss:function(e){var t=Math.floor(e/60);return e%=60,"".concat(this.pad(t),":").concat(this.pad(e))},hhmmss:function(e){var t=Math.floor(e/60);e%=60;var r=Math.floor(t/60);return t%=60,"".concat(this.pad(r),":").concat(this.pad(t),":").concat(this.pad(e))},getToday:function(){var e=new Date,dd=String(e.getDate()).padStart(2,"0"),t=String(e.getMonth()+1).padStart(2,"0");return e.getFullYear()+t+dd},getNow:function(){var e=new Date;return""+e.getFullYear()+this.pad(e.getMonth()+1)+this.pad(e.getDate())+this.pad(e.getHours())+this.pad(e.getMinutes())+this.pad(e.getSeconds())},obj2arr:function(e){var t=[],r=Object.keys(e);return r.sort(),r.forEach((function(r){t.push(Object.assign({id:r},e[r]))})),t},arr2obj:function(e){var t={};return e.forEach((function(e){var r=JSON.parse(JSON.stringify(e)),n=e.id;delete r.id,t[n]=r})),t},getOptions:function(e){var t=[];return e.split("#@@#").forEach((function(e){var s=e.split("#@");t.push({text:s[0],value:s[1]})})),t},findIdPos:function(e,t){if(!e)return-1;for(var r=0;r<e.length;r++)if(t==e[r].id)return r;return-1},encode:function(e,t){return new o.a(e).encrypt(t)},decode:function(e,t){return new o.a(e).decrypt(t)}};t.a=c},845:function(e,t,r){"use strict";var n=r(8),o=r(846).start;n({target:"String",proto:!0,forced:r(847)},{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},846:function(e,t,r){var n=r(50),o=r(228),c=r(52),d=Math.ceil,l=function(e){return function(t,r,l){var m,f,h=String(c(t)),v=h.length,x=void 0===l?" ":String(l),S=n(r);return S<=v||""==x?h:(m=S-v,(f=o.call(x,d(m/x.length))).length>m&&(f=f.slice(0,m)),e?h+f:f+h)}};e.exports={start:l(!1),end:l(!0)}},847:function(e,t,r){var n=r(127);e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)}}]);